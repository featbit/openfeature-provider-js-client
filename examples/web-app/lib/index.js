!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,(()=>(()=>{"use strict";var e={1123:function(e,t,r){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(l){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FbProvider=void 0;var a=r(9277),l=r(1726),u=r(5509),c=s(r(3435));function d(e){return{value:e,reason:a.StandardResolutionReasons.ERROR,errorCode:a.ErrorCode.TYPE_MISMATCH}}var h=function(){function e(e){var t,r=this;this.runsOn="client",this.metadata={name:"featbit-client-provider"},this._status=a.ProviderStatus.NOT_READY,this.events=new a.OpenFeatureEventEmitter;try{this.logger=null!==(t=e.logger)&&void 0!==t?t:new l.BasicLogger({level:"none",destination:console.log}),this.fbClient=new l.FbClientBuilder(n(n({},e),{logger:this.logger})).build(),this.fbClient.on("update",(function(e){return r.events.emit(a.ProviderEvents.ConfigurationChanged,{flagsChanged:e})}))}catch(e){this.clientConstructionError=e,this.logger.error("Encountered unrecoverable initialization error, ".concat(e)),this._status=a.ProviderStatus.ERROR}}return e.prototype.initialize=function(){return i(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:if(!this.fbClient){if(this.clientConstructionError)throw this.clientConstructionError;throw new Error("Unknown problem encountered during initialization")}t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.fbClient.waitForInitialization()];case 2:return t.sent(),this._status=a.ProviderStatus.READY,[3,4];case 3:throw e=t.sent(),this._status=a.ProviderStatus.ERROR,e;case 4:return[2]}}))}))},e.prototype.resolveBooleanEvaluation=function(e,t){var r=this.fbClient.boolVariation(e,t);return"boolean"!=typeof r?(this.logger.debug(a.ErrorCode.GENERAL),d(t)):(0,c.default)(r)},e.prototype.resolveStringEvaluation=function(e,t){var r=this.fbClient.stringVariation(e,t);return"string"!=typeof r?(this.logger.debug(a.ErrorCode.GENERAL),d(t)):(0,c.default)(r)},e.prototype.resolveNumberEvaluation=function(e,t){var r=this.fbClient.numberVariation(e,t);return"number"!=typeof r?(this.logger.debug(a.ErrorCode.GENERAL),d(t)):(0,c.default)(r)},e.prototype.resolveObjectEvaluation=function(e,t){var r=this.fbClient.jsonVariation(e,t);return void 0!==r?(0,c.default)(r):(this.logger.debug(a.ErrorCode.GENERAL),d(t))},e.prototype.onContextChange=function(e,t){return i(this,void 0,void 0,(function(){var e;return o(this,(function(r){switch(r.label){case 0:return(e=(0,u.translateContext)(t,this.logger))?[4,this.fbClient.identify(e)]:[3,2];case 1:return r.sent(),[3,3];case 2:return[2,Promise.reject(new Error("Something went wrong"))];case 3:return[2]}}))}))},e.prototype.getClient=function(){return this.fbClient},Object.defineProperty(e.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),e.prototype.onClose=function(){return i(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,this.fbClient.close()];case 1:return e.sent(),this._status=a.ProviderStatus.NOT_READY,[2]}}))}))},e}();t.FbProvider=h},1872:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FbProvider=void 0;var n=r(1123);Object.defineProperty(t,"FbProvider",{enumerable:!0,get:function(){return n.FbProvider}})},5509:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.translateContext=void 0;var r=["key","name","custom","targetingKey"];t.translateContext=function(e,t){var n=e.custom||[],i=e.name||"",o=e.targetingKey||e.key||e.keyId||"";""===o&&t.error("The EvaluationContext must contain either a 'targetingKey' or a 'key' or a 'keyId' and the type must be a string.");var s={keyId:o,name:i,customizedProperties:[]};return n&&(Array.isArray(n)?n.forEach((function(e){var t=e.name,r=e.value;t&&s.customizedProperties.push({name:t,value:r})})):"object"==typeof n&&Object.entries(n).forEach((function(e){var t=e[0],r=e[1];t&&s.customizedProperties.push({name:t,value:r})}))),Object.entries(e).forEach((function(e){var t=e[0],n=e[1];r.includes(t)||s.customizedProperties.push({name:t,value:n})})),s}},3435:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{value:e}}},5395:e=>{var t,r=Object.defineProperty,n=Object.defineProperties,i=Object.getOwnPropertyDescriptor,o=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertyNames,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,c=(e,t,n)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,d=(e,t)=>{for(var r in t||(t={}))l.call(t,r)&&c(e,r,t[r]);if(a)for(var r of a(t))u.call(t,r)&&c(e,r,t[r]);return e},h=(e,t)=>n(e,o(t)),v=(e,t,r)=>new Promise(((n,i)=>{var o=e=>{try{a(r.next(e))}catch(e){i(e)}},s=e=>{try{a(r.throw(e))}catch(e){i(e)}},a=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,s);a((r=r.apply(e,t)).next())})),f={};((e,t)=>{for(var n in t)r(e,n,{get:t[n],enumerable:!0})})(f,{AllProviderEvents:()=>C,ClientProviderEvents:()=>C,DefaultLogger:()=>A,ErrorCode:()=>m,FlagNotFoundError:()=>_,GeneralError:()=>y,GenericEventEmitter:()=>M,InvalidContextError:()=>P,LOG_LEVELS:()=>T,OpenFeatureCommonAPI:()=>V,OpenFeatureError:()=>p,ParseError:()=>b,ProviderNotReadyError:()=>w,ProviderStatus:()=>R,SafeLogger:()=>x,ServerProviderEvents:()=>S,StandardResolutionReasons:()=>g,TargetingKeyMissingError:()=>O,TypeMismatchError:()=>E,isObject:()=>L,isString:()=>D,objectOrUndefined:()=>I,statusMatchesEvent:()=>N,stringOrUndefined:()=>k}),e.exports=(t=f,((e,t,n,o)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of s(t))l.call(e,n)||undefined===n||r(e,n,{get:()=>t[n],enumerable:!(o=i(t,n))||o.enumerable});return e})(r({},"__esModule",{value:!0}),t));var p=class extends Error{constructor(e){super(e),Object.setPrototypeOf(this,p.prototype),this.name="OpenFeatureError"}},g={TARGETING_MATCH:"TARGETING_MATCH",SPLIT:"SPLIT",DISABLED:"DISABLED",DEFAULT:"DEFAULT",UNKNOWN:"UNKNOWN",STATIC:"STATIC",CACHED:"CACHED",ERROR:"ERROR"},m=(e=>(e.PROVIDER_NOT_READY="PROVIDER_NOT_READY",e.FLAG_NOT_FOUND="FLAG_NOT_FOUND",e.PARSE_ERROR="PARSE_ERROR",e.TYPE_MISMATCH="TYPE_MISMATCH",e.TARGETING_KEY_MISSING="TARGETING_KEY_MISSING",e.INVALID_CONTEXT="INVALID_CONTEXT",e.GENERAL="GENERAL",e))(m||{}),y=class extends p{constructor(e){super(e),Object.setPrototypeOf(this,y.prototype),this.name="GeneralError",this.code="GENERAL"}},_=class extends p{constructor(e){super(e),Object.setPrototypeOf(this,_.prototype),this.name="FlagNotFoundError",this.code="FLAG_NOT_FOUND"}},b=class extends p{constructor(e){super(e),Object.setPrototypeOf(this,b.prototype),this.name="ParseError",this.code="PARSE_ERROR"}},E=class extends p{constructor(e){super(e),Object.setPrototypeOf(this,E.prototype),this.name="TypeMismatchError",this.code="TYPE_MISMATCH"}},O=class extends p{constructor(e){super(e),Object.setPrototypeOf(this,O.prototype),this.name="TargetingKeyMissingError",this.code="TARGETING_KEY_MISSING"}},P=class extends p{constructor(e){super(e),Object.setPrototypeOf(this,P.prototype),this.name="InvalidContextError",this.code="INVALID_CONTEXT"}},w=class extends p{constructor(e){super(e),Object.setPrototypeOf(this,w.prototype),this.name="ProviderNotReadyError",this.code="PROVIDER_NOT_READY"}},R=(e=>(e.NOT_READY="NOT_READY",e.READY="READY",e.ERROR="ERROR",e.STALE="STALE",e))(R||{}),S=(e=>(e.Ready="PROVIDER_READY",e.Error="PROVIDER_ERROR",e.ConfigurationChanged="PROVIDER_CONFIGURATION_CHANGED",e.Stale="PROVIDER_STALE",e))(S||{}),C=(e=>(e.Ready="PROVIDER_READY",e.Error="PROVIDER_ERROR",e.ConfigurationChanged="PROVIDER_CONFIGURATION_CHANGED",e.ContextChanged="PROVIDER_CONTEXT_CHANGED",e.Stale="PROVIDER_STALE",e))(C||{}),j={READY:"PROVIDER_READY",ERROR:"PROVIDER_ERROR",STALE:"PROVIDER_STALE",NOT_READY:void 0},N=(e,t)=>!t&&"PROVIDER_READY"===e||j[t]===e,A=class{error(...e){console.error(...e)}warn(...e){console.warn(...e)}info(){}debug(){}},T=["error","warn","info","debug"],x=class{constructor(e){this.fallbackLogger=new A;try{for(const t of T)if(!e[t]||"function"!=typeof e[t])throw new Error(`The provided logger is missing the ${t} method.`);this.logger=e}catch(e){console.error(e),console.error("Falling back to the default logger."),this.logger=this.fallbackLogger}}error(...e){this.log("error",...e)}warn(...e){this.log("warn",...e)}info(...e){this.log("info",...e)}debug(...e){this.log("debug",...e)}log(e,...t){try{this.logger[e](...t)}catch(r){this.fallbackLogger[e](...t)}}},M=class{constructor(e){this.globalLogger=e,this._handlers=new WeakMap}emit(e,t){this.eventEmitter.emit(e,t)}addHandler(e,t){const r=e=>v(this,null,(function*(){yield t(e)}));this._handlers.set(t,r),this.eventEmitter.on(e,r)}removeHandler(e,t){const r=this._handlers.get(t);r&&this.eventEmitter.removeListener(e,r)}removeAllHandlers(e){e?this.eventEmitter.removeAllListeners(e):this.eventEmitter.removeAllListeners()}getHandlers(e){return this.eventEmitter.listeners(e)}setLogger(e){return this._eventLogger=new x(e),this}get _logger(){var e,t;return null!=(t=this._eventLogger)?t:null==(e=this.globalLogger)?void 0:e.call(this)}};function D(e){return"string"==typeof e}function k(e){return D(e)?e:void 0}function L(e){return"object"==typeof e}function I(e){return L(e)?e:void 0}function F(e){return null!=e}var V=class{constructor(e){this._hooks=[],this._context={},this._logger=new A,this._clientEventHandlers=new Map,this._clientProviders=new Map,this._clientEvents=new Map,this._runsOn=e}addHooks(...e){return this._hooks=[...this._hooks,...e],this}getHooks(){return this._hooks}clearHooks(){return this._hooks=[],this}setLogger(e){return this._logger=new x(e),this}get providerMetadata(){return this.getProviderMetadata()}getProviderMetadata(e){return this.getProviderForClient(e).metadata}addHandler(e,t){[...new Map([[void 0,this._defaultProvider]]),...this._clientProviders].forEach((r=>{var n;const i=r[0],o=r[1];if(N(e,r[1].status))try{t({clientName:i,providerName:o.metadata.name})}catch(e){null==(n=this._logger)||n.error("Error running event handler:",e)}})),this._events.addHandler(e,t)}removeHandler(e,t){this._events.removeHandler(e,t)}clearHandlers(){this._events.removeAllHandlers()}getHandlers(e){return this._events.getHandlers(e)}setProviderAndWait(e,t){return v(this,null,(function*(){yield this.setAwaitableProvider(e,t)}))}setProvider(e,t){const r=this.setAwaitableProvider(e,t);return r&&r.catch((()=>{})),this}setAwaitableProvider(e,t){var r,n,i,o,s,a;const l=k(e),u=null!=(r=I(e))?r:I(t);if(!u)return void this._logger.debug("No provider defined, ignoring setProvider call");const c=this.getProviderForClient(l),d=u.metadata.name;if(c===u)return void this._logger.debug("Provider is already set, ignoring setProvider call");if(u.runsOn){if(u.runsOn!==this._runsOn)throw new y(`Provider '${u.metadata.name}' is intended for use on the ${u.runsOn}.`)}else this._logger.debug(`Provider '${u.metadata.name}' has not defined its intended use.`);const h=this.getAssociatedEventEmitters(l);let v;return"function"==typeof u.initialize&&void 0===u.status&&(this._logger||console).warn(`Provider ${d} implements 'initialize' but not 'status'. Please implement 'status'.`),"NOT_READY"===(null==u?void 0:u.status)&&"function"==typeof u.initialize?v=null==(o=null==(i=null==(n=u.initialize)?void 0:n.call(u,this._context))?void 0:i.then((()=>{var e;this.getAssociatedEventEmitters(l).forEach((e=>{null==e||e.emit("PROVIDER_READY",{clientName:l,providerName:d})})),null==(e=this._events)||e.emit("PROVIDER_READY",{clientName:l,providerName:d})})))?void 0:o.catch((e=>{var t;throw this.getAssociatedEventEmitters(l).forEach((t=>{null==t||t.emit("PROVIDER_ERROR",{clientName:l,providerName:d,message:null==e?void 0:e.message})})),null==(t=this._events)||t.emit("PROVIDER_ERROR",{clientName:l,providerName:d,message:null==e?void 0:e.message}),e})):(h.forEach((e=>{null==e||e.emit("PROVIDER_READY",{clientName:l,providerName:d})})),null==(s=this._events)||s.emit("PROVIDER_READY",{clientName:l,providerName:d})),l?this._clientProviders.set(l,u):this._defaultProvider=u,this.transferListeners(c,u,l,h),[...this._clientProviders.values(),this._defaultProvider].includes(c)||null==(a=null==c?void 0:c.onClose)||a.call(c),v}getProviderForClient(e){var t;return e&&null!=(t=this._clientProviders.get(e))?t:this._defaultProvider}buildAndCacheEventEmitterForClient(e){const t=this._clientEvents.get(e);if(t)return t;const r=this._createEventEmitter();this._clientEvents.set(e,r);const n=this.getProviderForClient(e);return Object.values(C).forEach((t=>{var i;return null==(i=n.events)?void 0:i.addHandler(t,(i=>v(this,null,(function*(){r.emit(t,h(d({},i),{clientName:e,providerName:n.metadata.name}))}))))})),r}getUnboundEmitters(){const e=[...this._clientProviders.keys()];return[...[...this._clientEvents.keys()].filter(F).filter((t=>!e.includes(t))).map((e=>this._clientEvents.get(e))),this._clientEvents.get(void 0)].filter(F)}getAssociatedEventEmitters(e){return e?[this.buildAndCacheEventEmitterForClient(e)]:this.getUnboundEmitters()}transferListeners(e,t,r,n){var i;null==(i=this._clientEventHandlers.get(r))||i.forEach((t=>{var r;return null==(r=e.events)?void 0:r.removeHandler(...t)}));const o=Object.values(C).map((e=>[e,i=>v(this,null,(function*(){n.forEach((n=>{null==n||n.emit(e,h(d({},i),{clientName:r,providerName:t.metadata.name}))})),this._events.emit(e,h(d({},i),{clientName:r,providerName:t.metadata.name}))}))]));this._clientEventHandlers.set(r,o),o.forEach((e=>{var r;return null==(r=t.events)?void 0:r.addHandler(...e)}))}close(){return v(this,null,(function*(){var e,t;try{yield null==(t=null==(e=null==this?void 0:this._defaultProvider)?void 0:e.onClose)?void 0:t.call(e)}catch(e){this.handleShutdownError(this._defaultProvider,e)}const r=Array.from(this._clientProviders);yield Promise.all(r.map((e=>v(this,[e],(function*([,e]){var t;try{yield null==(t=e.onClose)?void 0:t.call(e)}catch(t){this.handleShutdownError(e,t)}})))))}))}clearProvidersAndSetDefault(e){return v(this,null,(function*(){try{yield this.close()}catch(e){this._logger.error("Unable to cleanly close providers. Resetting to the default configuration.")}finally{this._clientProviders.clear(),this._defaultProvider=e}}))}handleShutdownError(e,t){this._logger.error(`Error during shutdown of provider ${e.metadata.name}: ${t}`),this._logger.error(null==t?void 0:t.stack)}}},6452:(e,t,r)=>{var n,i,o=Object.create,s=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyDescriptors,c=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,h=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable,p=Reflect.get,g=(e,t,r)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,m=(e,t)=>{for(var r in t||(t={}))v.call(t,r)&&g(e,r,t[r]);if(d)for(var r of d(t))f.call(t,r)&&g(e,r,t[r]);return e},y=(e,t)=>a(e,u(t)),_=(e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let i of c(t))v.call(e,i)||i===r||s(e,i,{get:()=>t[i],enumerable:!(n=l(t,i))||n.enumerable});return e},b=(e,t,r)=>new Promise(((n,i)=>{var o=e=>{try{a(r.next(e))}catch(e){i(e)}},s=e=>{try{a(r.throw(e))}catch(e){i(e)}},a=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,s);a((r=r.apply(e,t)).next())})),E=(n={"../../node_modules/events/events.js"(e,t){var r,n="object"==typeof Reflect?Reflect:null,i=n&&"function"==typeof n.apply?n.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};r=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}t.exports=s,t.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}g(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&g(e,"error",t,{once:!0})}(e,i)}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var a=10;function l(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function c(e,t,r,n){var i,o,s,a;if(l(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=u(e))>0&&s.length>i&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,a=c,console&&console.warn&&console.warn(a)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=d.bind(n);return i.listener=r,n.wrapFn=i,i}function v(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):p(i,i.length)}function f(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function g(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return u(this)},s.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,o=this._events;if(void 0!==o)n=n&&void 0===o.error;else if(!n)return!1;if(n){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[e];if(void 0===l)return!1;if("function"==typeof l)i(l,this,t);else{var u=l.length,c=p(l,u);for(r=0;r<u;++r)i(c[r],this,t)}return!0},s.prototype.addListener=function(e,t){return c(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return c(this,e,t,!0)},s.prototype.once=function(e,t){return l(t),this.on(e,h(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return l(t),this.prependListener(e,h(this,e,t)),this},s.prototype.removeListener=function(e,t){var r,n,i,o,s;if(l(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},s.prototype.listeners=function(e){return v(this,e,!0)},s.prototype.rawListeners=function(e){return v(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},s.prototype.listenerCount=f,s.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}}},function(){return i||(0,n[c(n)[0]])((i={exports:{}}).exports,i),i.exports}),O={};((e,t)=>{for(var r in t)s(e,r,{get:t[r],enumerable:!0})})(O,{InMemoryProvider:()=>D,NOOP_PROVIDER:()=>A,OpenFeature:()=>F,OpenFeatureAPI:()=>I,OpenFeatureClient:()=>V,OpenFeatureEventEmitter:()=>C,ProviderEvents:()=>j.ClientProviderEvents}),e.exports=(e=>_(s({},"__esModule",{value:!0}),e))(O);var P=r(5395),w=r(5395),R=r(5395),S=((e,t,r)=>(r=null!=e?o(h(e)):{},_(e&&e.__esModule?r:s(r,"default",{value:e,enumerable:!0}),e)))(E()),C=class extends R.GenericEventEmitter{constructor(){super(),this.eventEmitter=new S.default({captureRejections:!0}),this.eventEmitter.on("error",(e=>{var t;null==(t=this._logger)||t.error("Error running event handler:",e)}))}},j=r(5395),N=r(5395),A=new class{constructor(){this.metadata={name:"No-op Provider"}}get status(){return N.ProviderStatus.NOT_READY}resolveBooleanEvaluation(e,t){return this.noOp(t)}resolveStringEvaluation(e,t){return this.noOp(t)}resolveNumberEvaluation(e,t){return this.noOp(t)}resolveObjectEvaluation(e,t){return this.noOp(t)}noOp(e){return{value:e,reason:"No-op"}}},T=r(5395),x=r(5395),M=class extends x.OpenFeatureError{constructor(e){super(e),Object.setPrototypeOf(this,M.prototype),this.name="VariantNotFoundError",this.code=x.ErrorCode.GENERAL}},D=class{constructor(e={}){this.events=new C,this.runsOn="client",this.status=T.ProviderStatus.NOT_READY,this.metadata={name:"in-memory"},this._flagConfiguration=m({},e)}initialize(e){return b(this,null,(function*(){try{for(const t in this._flagConfiguration)this.resolveFlagWithReason(t,e);this._context=e,this.status=T.ProviderStatus.READY}catch(e){throw this.status=T.ProviderStatus.ERROR,e}}))}putConfiguration(e){return b(this,null,(function*(){const t=Object.entries(e).filter((([e,t])=>this._flagConfiguration[e]!==t)).map((([e])=>e));this.status=T.ProviderStatus.STALE,this.events.emit(j.ClientProviderEvents.Stale),this._flagConfiguration=m({},e),this.events.emit(j.ClientProviderEvents.ConfigurationChanged,{flagsChanged:t});try{yield this.initialize(this._context),this.events.emit(j.ClientProviderEvents.Ready)}catch(e){throw this.events.emit(j.ClientProviderEvents.Error),e}}))}resolveBooleanEvaluation(e,t,r,n){return this.resolveAndCheckFlag(e,t,r||this._context,n)}resolveNumberEvaluation(e,t,r,n){return this.resolveAndCheckFlag(e,t,r||this._context,n)}resolveStringEvaluation(e,t,r,n){return this.resolveAndCheckFlag(e,t,r||this._context,n)}resolveObjectEvaluation(e,t,r,n){return this.resolveAndCheckFlag(e,t,r||this._context,n)}resolveAndCheckFlag(e,t,r,n){if(!(e in this._flagConfiguration)){const t=`no flag found with key ${e}`;throw null==n||n.debug(t),new T.FlagNotFoundError(t)}if(this._flagConfiguration[e].disabled)return{value:t,reason:T.StandardResolutionReasons.DISABLED};const i=this.resolveFlagWithReason(e,r);if(void 0===i.value){const t=`no value associated with variant provided for ${e} found`;throw null==n||n.error(t),new M(t)}if(typeof i.value!=typeof t)throw new T.TypeMismatchError;return i}resolveFlagWithReason(e,t){try{return this.lookupFlagValue(e,t)}catch(e){if(!(e instanceof T.OpenFeatureError))throw new T.GeneralError((null==e?void 0:e.message)||"unknown error");throw e}}lookupFlagValue(e,t){var r;const n=this._flagConfiguration[e],i=t&&(null==n?void 0:n.contextEvaluator),o=i?null==(r=n.contextEvaluator)?void 0:r.call(n,t):n.defaultVariant,s=o&&(null==n?void 0:n.variants[o]),a=i?T.StandardResolutionReasons.TARGETING_MATCH:T.StandardResolutionReasons.STATIC,l=this.status===T.ProviderStatus.STALE?T.StandardResolutionReasons.CACHED:a;return y(m({value:s},o&&{variant:o}),{reason:l})}},k=Symbol.for("@openfeature/web-sdk/api"),L=globalThis,I=class extends w.OpenFeatureCommonAPI{constructor(){super("client"),this._events=new C,this._defaultProvider=A,this._createEventEmitter=()=>new C,this._namedProviderContext=new Map}static getInstance(){const e=L[k];if(e)return e;const t=new I;return L[k]=t,t}setContext(e,t){return b(this,null,(function*(){var r,n;const i=(0,w.stringOrUndefined)(e),o=null!=(n=null!=(r=(0,w.objectOrUndefined)(e))?r:(0,w.objectOrUndefined)(t))?n:{};if(i){const e=this._clientProviders.get(i);if(e){const t=this.getContext(i);this._namedProviderContext.set(i,o),yield this.runProviderContextChangeHandler(i,e,t,o)}else this._namedProviderContext.set(i,o)}else{const e=this._context;this._context=o;const t=Array.from(this._clientProviders.entries()).filter((([e])=>!this._namedProviderContext.has(e))).reduce(((e,[t,r])=>(e.push({name:t,provider:r}),e)),[]),r=[{name:void 0,provider:this._defaultProvider},...t];yield Promise.all(r.map((t=>this.runProviderContextChangeHandler(t.name,t.provider,e,o))))}}))}getContext(e){const t=(0,w.stringOrUndefined)(e);if(t){const e=this._namedProviderContext.get(t);if(e)return e;this._logger.debug(`Unable to find context for '${t}'.`)}return this._context}clearContext(e){return b(this,null,(function*(){const t=(0,w.stringOrUndefined)(e);if(!t)return this.setContext({});{const e=this._clientProviders.get(t);if(e){const r=this.getContext(t);this._namedProviderContext.delete(t);const n=this.getContext();yield this.runProviderContextChangeHandler(t,e,r,n)}else this._namedProviderContext.delete(t)}}))}clearContexts(){return b(this,null,(function*(){yield this.clearContext(),yield Promise.allSettled(Array.from(this._clientProviders.keys()).map((e=>this.clearContext(e))))}))}getClient(e,t){return new V((()=>this.getProviderForClient(e)),(()=>this.buildAndCacheEventEmitterForClient(e)),(()=>this._logger),{name:e,version:t})}clearProviders(){return b(this,null,(function*(){var e;yield(e=I.prototype,this,"clearProvidersAndSetDefault",p(h(e),"clearProvidersAndSetDefault",this)).call(this,A),this._namedProviderContext.clear()}))}runProviderContextChangeHandler(e,t,r,n){return b(this,null,(function*(){var i,o,s,a,l;const u=t.metadata.name;try{yield null==(i=t.onContextChange)?void 0:i.call(t,r,n),this.getAssociatedEventEmitters(e).forEach((t=>{null==t||t.emit(j.ClientProviderEvents.ContextChanged,{clientName:e,providerName:u})})),null==(o=this._events)||o.emit(j.ClientProviderEvents.ContextChanged,{clientName:e,providerName:u})}catch(r){const n=r,i=`Error running ${null==(s=null==t?void 0:t.metadata)?void 0:s.name}'s context change handler: ${null==n?void 0:n.message}`;null==(a=this._logger)||a.error(`${i}`,r),this.getAssociatedEventEmitters(e).forEach((t=>{null==t||t.emit(j.ClientProviderEvents.Error,{clientName:e,providerName:u,message:i})})),null==(l=this._events)||l.emit(j.ClientProviderEvents.Error,{clientName:e,providerName:u,message:i})}}))}},F=I.getInstance(),V=class{constructor(e,t,r,n){this.providerAccessor=e,this.emitterAccessor=t,this.globalLogger=r,this.options=n,this._hooks=[]}get metadata(){return{name:this.options.name,version:this.options.version,providerMetadata:this.providerAccessor().metadata}}get providerStatus(){var e;return(null==(e=this.providerAccessor())?void 0:e.status)||P.ProviderStatus.READY}addHandler(e,t){var r;if(this.emitterAccessor().addHandler(e,t),(0,P.statusMatchesEvent)(e,this._provider.status))try{t({clientName:this.metadata.name,providerName:this._provider.metadata.name})}catch(e){null==(r=this._logger)||r.error("Error running event handler:",e)}}removeHandler(e,t){this.emitterAccessor().removeHandler(e,t)}getHandlers(e){return this.emitterAccessor().getHandlers(e)}setLogger(e){return this._clientLogger=new P.SafeLogger(e),this}addHooks(...e){return this._hooks=[...this._hooks,...e],this}getHooks(){return this._hooks}clearHooks(){return this._hooks=[],this}getBooleanValue(e,t,r){return this.getBooleanDetails(e,t,r).value}getBooleanDetails(e,t,r){return this.evaluate(e,this._provider.resolveBooleanEvaluation,t,"boolean",r)}getStringValue(e,t,r){return this.getStringDetails(e,t,r).value}getStringDetails(e,t,r){return this.evaluate(e,this._provider.resolveStringEvaluation,t,"string",r)}getNumberValue(e,t,r){return this.getNumberDetails(e,t,r).value}getNumberDetails(e,t,r){return this.evaluate(e,this._provider.resolveNumberEvaluation,t,"number",r)}getObjectValue(e,t,r){return this.getObjectDetails(e,t,r).value}getObjectDetails(e,t,r){return this.evaluate(e,this._provider.resolveObjectEvaluation,t,"object",r)}evaluate(e,t,r,n,i={}){var o,s;const a=[...F.getHooks(),...this.getHooks(),...i.hooks||[],...this._provider.hooks||[]],l=[...a].reverse(),u=m({},F.getContext(null==(o=null==this?void 0:this.options)?void 0:o.name)),c={flagKey:e,defaultValue:r,flagValueType:n,clientMetadata:this.metadata,providerMetadata:F.providerMetadata,context:u,logger:this._logger};try{this.beforeHooks(a,c,i);const n=t.call(this._provider,e,r,u,this._logger),o=y(m({},n),{flagMetadata:Object.freeze(null!=(s=n.flagMetadata)?s:{}),flagKey:e});return this.afterHooks(l,c,o,i),o}catch(t){const n=null==t?void 0:t.message,o=(null==t?void 0:t.code)||P.ErrorCode.GENERAL;return this.errorHooks(l,c,t,i),{errorCode:o,errorMessage:n,value:r,reason:P.StandardResolutionReasons.ERROR,flagMetadata:Object.freeze({}),flagKey:e}}finally{this.finallyHooks(l,c,i)}}beforeHooks(e,t,r){var n;Object.freeze(t),Object.freeze(t.context);for(const i of e)null==(n=null==i?void 0:i.before)||n.call(i,t,Object.freeze(r.hookHints))}afterHooks(e,t,r,n){var i;for(const o of e)null==(i=null==o?void 0:o.after)||i.call(o,t,r,n.hookHints)}errorHooks(e,t,r,n){var i;for(const o of e)try{null==(i=null==o?void 0:o.error)||i.call(o,t,r,n.hookHints)}catch(e){this._logger.error(`Unhandled error during 'error' hook: ${e}`),e instanceof Error&&this._logger.error(e.stack),this._logger.error(null==e?void 0:e.stack)}}finallyHooks(e,t,r){var n;for(const i of e)try{null==(n=null==i?void 0:i.finally)||n.call(i,t,r.hookHints)}catch(e){this._logger.error(`Unhandled error during 'finally' hook: ${e}`),e instanceof Error&&this._logger.error(e.stack),this._logger.error(null==e?void 0:e.stack)}}get _provider(){return this.providerAccessor()}get _logger(){return this._clientLogger||this.globalLogger()}};((e,t,r)=>{_(e,t,"default"),r&&_(r,t,"default")})(O,r(5395),e.exports)},3607:function(e,t,r){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(l){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=r(1872),a=r(6452);i(void 0,void 0,void 0,(function(){var e,t,r,i;return o(this,(function(o){switch(o.label){case 0:return e={sdkKey:"Obg68EqYZk27JTxphPgy7At1aJ8GaAtEaIA1fb3IpuEA",streamingUri:"wss://app-eval.featbit.co",eventsUri:"https://app-eval.featbit.co",user:{name:"the-user",keyId:"the-user",customizedProperties:[]}},t=new s.FbProvider(e),[4,a.OpenFeature.setProviderAndWait(t)];case 1:return o.sent(),a.OpenFeature.addHandler(a.ProviderEvents.ConfigurationChanged,(function(e){var t=a.OpenFeature.getClient().getStringValue("robot","ChatGPT");console.log(n(n({},e),{value:t}))})),r=a.OpenFeature.getClient(),i=r.getStringValue("robot","ChatGPT"),console.log(i),[2]}}))}))},3630:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.defaultValues=void 0;const i=r(4962),o=n(r(1475)),s=n(r(7769)),a=r(5772),l=r(8058),u=r(3229),c=r(9677),d=r(2791),h=r(8559),v={startWaitTime:i.TypeValidators.Number,sdkKey:i.TypeValidators.String,pollingUri:i.TypeValidators.String,streamingUri:i.TypeValidators.String,eventsUri:i.TypeValidators.String,webSocketPingInterval:i.TypeValidators.Number,logger:i.TypeValidators.Object,store:i.TypeValidators.ObjectOrFactory,dataSynchronizer:i.TypeValidators.ObjectOrFactory,flushInterval:i.TypeValidators.Number,maxEventsInQueue:i.TypeValidators.Number,pollingInterval:i.TypeValidators.Number,offline:i.TypeValidators.Boolean,dataSyncMode:i.TypeValidators.String,bootstrap:i.TypeValidators.Bootstrap,user:i.TypeValidators.User};t.defaultValues={startWaitTime:5e3,sdkKey:"",pollingUri:"",streamingUri:"",eventsUri:"",dataSyncMode:d.DataSyncModeEnum.STREAMING,sendEvents:!0,webSocketPingInterval:18e3,flushInterval:2e3,maxEventsInQueue:1e4,pollingInterval:3e4,offline:!1,store:e=>new s.default,bootstrap:void 0,user:void 0},t.default=class{constructor(e={}){var r,n;this.bootstrapProvider=new u.NullBootstrapProvider,e=e||{},this.logger=e.logger;const{errors:s,validatedOptions:f}=function(e){let r=[];const n=Object.assign({},t.defaultValues);return Object.keys(e).forEach((s=>{var a;const l=e[s],u=v[s];if(u)if(u.is(l))n[s]=l;else if("boolean"===u.getType())r.push(o.default.wrongOptionTypeBoolean(s,typeof l)),n[s]=!!l;else if(u instanceof i.NumberWithMinimum&&i.TypeValidators.Number.is(l)){const{min:e}=u;r.push(o.default.optionBelowMinimum(s,l,e)),n[s]=e}else u instanceof i.UserValidator?(r=[...r,...u.messages],n[s]=t.defaultValues[s]):(r.push(o.default.wrongOptionType(s,u.getType(),typeof l)),n[s]=t.defaultValues[s]);else null===(a=e.logger)||void 0===a||a.warn(o.default.unknownOption(s))})),{errors:r,validatedOptions:n}}(e);if(s.forEach((e=>{var t;null===(t=this.logger)||void 0===t||t.warn(e)})),this.user=e.user,function(e,t){var r,n,i;const{streamingUri:s,pollingUri:l,eventsUri:u}=e,h=(0,a.isNullOrUndefined)(s)||s===c.EmptyString,v=(0,a.isNullOrUndefined)(l)||l===c.EmptyString,f=(0,a.isNullOrUndefined)(u)||u===c.EmptyString;!t.offline&&(f||h&&v)&&(f&&(null===(r=t.logger)||void 0===r||r.error(o.default.partialEndpoint("eventsUri"))),t.dataSyncMode===d.DataSyncModeEnum.STREAMING&&h&&(null===(n=t.logger)||void 0===n||n.error(o.default.partialEndpoint("streamingUri"))),t.dataSyncMode===d.DataSyncModeEnum.POLLING&&v&&(null===(i=t.logger)||void 0===i||i.error(o.default.partialEndpoint("pollingUri"))))}(e,f),this.streamingUri=`${(0,l.canonicalizeUri)(f.streamingUri)}/streaming`,this.pollingUri=`${(0,l.canonicalizeUri)(f.pollingUri)}/api/public/sdk/client/latest-all`,this.eventsUri=`${(0,l.canonicalizeUri)(f.eventsUri)}/api/public/insight/track`,this.startWaitTime=f.startWaitTime,this.sdkKey=f.sdkKey,this.webSocketPingInterval=f.webSocketPingInterval,this.flushInterval=f.flushInterval,this.maxEventsInQueue=f.maxEventsInQueue,this.pollingInterval=f.pollingInterval,this.offline=f.offline,f.bootstrap&&f.bootstrap.length>0)try{this.bootstrapProvider=new h.JsonBootstrapProvider(f.bootstrap)}catch(e){null===(r=this.logger)||void 0===r||r.error("Failed to parse bootstrap JSON, use NullBootstrapProvider.")}this.offline&&(null===(n=this.logger)||void 0===n||n.info("Offline mode enabled. No data synchronization with the FeatBit server will occur.")),this.dataSyncMode=f.dataSyncMode,i.TypeValidators.Function.is(f.dataSynchronizer)?this.dataSynchronizerFactory=f.dataSynchronizer:this.dataSynchronizerFactory=()=>f.dataSynchronizer,i.TypeValidators.Function.is(f.store)?this.storeFactory=f.store:this.storeFactory=()=>f.store}}},1443:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e,t){this.valid=e,this.message=t}static fromUser(e){if(!e)return r.contextForError("No user specified");const{keyId:t,name:n}=e;if(null==t||""===t.trim())return r.contextForError("key is mandatory");const i=new r(!0);return i._user=e,i}get user(){return this._user}get keyId(){return this._user.keyId}value(e){var t,r,n,i,o;return"keyId"===e?null===(t=this._user)||void 0===t?void 0:t.keyId:"name"===e?null===(r=this._user)||void 0===r?void 0:r.name:null===(o=null===(i=null===(n=this._user)||void 0===n?void 0:n.customizedProperties)||void 0===i?void 0:i.find((t=>t.name===e)))||void 0===o?void 0:o.value}static contextForError(e){return new r(!1,e)}}t.default=r},4309:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FbClientBuilder=void 0;const i=n(r(7106));t.FbClientBuilder=class{constructor(e){this._options=null!=e?e:{}}build(){return new i.default(this._options,this._platform)}platform(e){return this._platform=e,this}startWaitTime(e){return this._options.startWaitTime=e,this}sdkKey(e){return this._options.sdkKey=e,this}user(e){return this._options.user=e,this}streamingUri(e){return this._options.streamingUri=e,this}pollingUri(e){return this._options.pollingUri=e,this}eventsUri(e){return this._options.eventsUri=e,this}dataSyncMode(e){return this._options.dataSyncMode=e,this}pollingInterval(e){return this._options.pollingInterval=e,this}flushInterval(e){return this._options.flushInterval=e,this}maxEventsInQueue(e){return this._options.maxEventsInQueue=e,this}logger(e){return this._options.logger=e,this}offline(e){return this._options.offline=e,this}bootstrap(e){return this._options.bootstrap=e,this}dataSynchronizer(e){return this._options.dataSynchronizer=e,this}}},2408:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FbClientCore=void 0;const o=i(r(3630)),s=i(r(5778)),a=i(r(5219)),l=r(2453),u=i(r(4813)),c=i(r(3043)),d=i(r(216)),h=i(r(1410)),v=i(r(942)),f=r(9435),p=r(7428),g=i(r(1443)),m=r(7378),y=r(5384),_=r(1039),b=r(5726),E=r(4111),O=r(2791),P=r(4962);var w;!function(e){e[e.Initializing=0]="Initializing",e[e.Initialized=1]="Initialized",e[e.Failed=2]="Failed"}(w||(w={})),t.FbClientCore=class{constructor(e,t,r){this.options=e,this.platform=t,this.state=w.Initializing,this.onError=r.onError,this.onFailed=r.onFailed,this.onReady=r.onReady;const{onUpdate:n,hasEventListeners:i}=r,s=new o.default(e);if(!s.sdkKey&&!s.offline)throw new Error("You must configure the client with an SDK key");if(!s.user)throw new Error("You must configure the client with a user");this.config=s,this.logger=s.logger,this.init(t,n,i)}init(e,t,r){var i,o,h;return n(this,void 0,void 0,(function*(){const n=new s.default(this.config.sdkKey,this.config,e);if(this.store=this.config.storeFactory(n),yield this.store.identify(this.config.user),this.dataSourceUpdates=new a.default(this.store,r,t),this.evaluator=new v.default(this.store),yield this.config.bootstrapProvider.populate(this.config.user.keyId,this.dataSourceUpdates),this.config.offline)this.eventProcessor=new _.NullEventProcessor,this.dataSynchronizer=new y.NullDataSynchronizer,this.initSuccess();else{this.eventProcessor=new b.DefaultEventProcessor(n);const t=(0,l.createStreamListeners)(this.dataSourceUpdates,this.logger,{put:()=>this.initSuccess(),patch:()=>this.initSuccess()}),r=this.config.dataSyncMode===O.DataSyncModeEnum.STREAMING?new u.default(this.config.sdkKey,this.config.user,n,e.webSocket,(()=>this.store.version),t,this.config.webSocketPingInterval):new c.default(this.config,new d.default(this.config.sdkKey,this.config,this.platform.info,this.platform.requests),(()=>this.store.version),t,(e=>this.dataSourceErrorHandler(e)));this.dataSynchronizer=null!==(h=null===(o=(i=this.config).dataSynchronizerFactory)||void 0===o?void 0:o.call(i,n,this.store,this.dataSourceUpdates,(()=>this.initSuccess()),(e=>this.dataSourceErrorHandler(e))))&&void 0!==h?h:r}this.start()}))}identify(e){return n(this,void 0,void 0,(function*(){const t=new P.UserValidator;if(!t.is(e))return void t.messages.forEach((e=>{var t;null===(t=this.logger)||void 0===t||t.warn(e)}));this.config.user=e,yield this.store.identify(e),this.dataSynchronizer.identify(e);const[r]=this.store.all(h.default.Flags);0===Object.keys(r).length&&(yield this.config.bootstrapProvider.populate(e.keyId,this.dataSourceUpdates))}))}start(){this.config.offline||(this.dataSynchronizer.start(),setTimeout((()=>{var e,t;if(!this.initialized()){const r=`FbClient failed to start successfully within ${this.config.startWaitTime} milliseconds. This error usually indicates a connection issue with FeatBit or an invalid sdkKey.Please double-check your sdkKey and streamingUri/pollingUri configuration. We will continue to initialize the FbClient, it still have a chance to get to work if it's a temporary network issue`,n=new Error(r);return this.state=w.Failed,this.rejectionReason=n,null===(e=this.initReject)||void 0===e||e.call(this,n),null===(t=this.logger)||void 0===t?void 0:t.warn(r)}}),this.config.startWaitTime))}initialized(){return this.state===w.Initialized}waitForInitialization(){return this.initializedPromise?this.initializedPromise:this.state===w.Initialized?(this.initializedPromise=Promise.resolve(this),this.initializedPromise):this.state===w.Failed?(this.initializedPromise=Promise.reject(this.rejectionReason),this.initializedPromise):(this.initializedPromise||(this.initializedPromise=new Promise(((e,t)=>{this.initResolve=e,this.initReject=t}))),this.initializedPromise)}boolVariation(e,t){return this.evaluateCore(e,t,m.ValueConverters.bool).value}boolVariationDetail(e,t){return this.evaluateCore(e,t,m.ValueConverters.bool)}jsonVariation(e,t){return this.evaluateCore(e,t,m.ValueConverters.json).value}jsonVariationDetail(e,t){return this.evaluateCore(e,t,m.ValueConverters.json)}numberVariation(e,t){return this.evaluateCore(e,t,m.ValueConverters.number).value}numberVariationDetail(e,t){return this.evaluateCore(e,t,m.ValueConverters.number)}stringVariation(e,t){return this.evaluateCore(e,t,m.ValueConverters.string).value}stringVariationDetail(e,t){return this.evaluateCore(e,t,m.ValueConverters.string)}variation(e,t){return this.evaluateCore(e,t,m.ValueConverters.string).value}variationDetail(e,t){return this.evaluateCore(e,t,m.ValueConverters.string)}getAllVariations(){var e;const t=g.default.fromUser(this.config.user);if(!t.valid){const r=new p.ClientError(`${null!==(e=t.message)&&void 0!==e?e:"User not valid;"} returning default value.`);return this.onError(r),Promise.resolve([])}const[r,n]=this.store.all(h.default.Flags),i=Object.keys(r).map((e=>{var t;const r=this.evaluator.evaluate(e);return{flagKey:e,kind:r.kind,reason:r.reason,value:null===(t=r.value)||void 0===t?void 0:t.variation}}));return Promise.resolve(i)}close(){var e;return n(this,void 0,void 0,(function*(){yield this.eventProcessor.close(),null===(e=this.dataSynchronizer)||void 0===e||e.close(),this.store.close()}))}track(e,t){const r=new E.MetricEvent(this.config.user,e,this.platform.info.appType,null!=t?t:1);this.eventProcessor.record(r)}flush(e){return n(this,void 0,void 0,(function*(){try{return yield this.eventProcessor.flush(),null==e||e(!0),!0}catch(t){return null==e||e(!1),!1}}))}evaluateCore(e,t,r){var n,i,o;const s=g.default.fromUser(this.config.user);if(!s.valid){const r=new p.ClientError(`${null!==(n=s.message)&&void 0!==n?n:"User not valid;"} returning default value.`);return this.onError(r),{flagKey:e,kind:f.ReasonKinds.Error,reason:r.message,value:t}}const a=this.evaluator.evaluate(e);if(a.kind===f.ReasonKinds.FlagNotFound){const r=new p.ClientError(a.reason);return this.onError(r),{flagKey:e,kind:a.kind,reason:a.reason,value:t}}this.initialized()?this.eventProcessor.record(a.toEvalEvent(this.config.user)):null===(i=this.logger)||void 0===i||i.warn("Variation called before FeatBit client initialization completed (did you wait for the'ready' event?)");const{isSucceeded:l,value:u}=r(null===(o=a.value)||void 0===o?void 0:o.variation);return l?{flagKey:e,kind:a.kind,reason:a.reason,value:u}:{flagKey:e,kind:f.ReasonKinds.WrongType,reason:"type mismatch",value:t}}dataSourceErrorHandler(e){var t;const r=401===e.code?new Error("Authentication failed. Double check your SDK key."):e;this.onError(r),this.onFailed(r),this.initialized()||(this.state=w.Failed,this.rejectionReason=r,null===(t=this.initReject)||void 0===t||t.call(this,r))}initSuccess(){var e,t;this.initialized()||(this.state=w.Initialized,null===(e=this.logger)||void 0===e||e.info("FbClient started successfully."),null===(t=this.initResolve)||void 0===t||t.call(this,this),this.onReady())}}},3529:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6267:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},649:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5615:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},8148:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9278:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.JsonBootstrapProvider=void 0;const n=r(5553),i=r(5772);t.JsonBootstrapProvider=class{constructor(e){const t=(e||[]).map((e=>Object.assign(Object.assign({},e),{variationOptions:e.variationOptions||[{id:null,variation:e.variation}]}))),r=(0,n.deserializeAll)(t);this.dataSet={flags:r.flags,version:0}}populate(e,t,r){return new Promise(((n,o)=>{if((0,i.isNullOrUndefined)(this.dataSet))return n();t.init(e,this.dataSet,(()=>{n(),null==r||r()}))}))}}},3229:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NullBootstrapProvider=void 0,t.NullBootstrapProvider=class{constructor(){this.dataSet={flags:{},version:0}}populate(e,t,r){return new Promise(((e,t)=>{e(),null==r||r()}))}}},8559:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(8148),t),i(r(9278),t),i(r(3229),t)},9677:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MinInt=t.EmptyString=void 0,t.EmptyString="",t.MinInt=2147483648},5219:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(r(1410));t.default=class{constructor(e,t,r){this.store=e,this.hasEventListeners=t,this.onChange=r}init(e,t,r){if(e!==this.store.user.keyId)return void(null==r||r());const i=this.hasEventListeners(),s=e=>n(this,void 0,void 0,(function*(){yield this.store.init(t),Promise.resolve().then((()=>{if(i){const r=Object.keys(t).flatMap((r=>{const n=(null==e?void 0:e[r])||{},i=t[r],o=Object.assign(Object.assign({},n),i);return Object.keys(o).filter((e=>this.isUpdated(n&&n[e],i&&i[e])))}));r.length>0&&this.onChange(r)}})),null==r||r()}));if(i){const[e,t]=this.store.all(o.default.Flags);s({flags:e,version:t})}else s()}upsert(e,t,r,i){if(e!==this.store.user.keyId)return void(null==i||i());const{key:o}=r,s=this.hasEventListeners(),a=e=>n(this,void 0,void 0,(function*(){yield this.store.upsert(t,r),Promise.resolve().then((()=>{s&&this.isUpdated(e,r[o])&&this.onChange([o])})),null==i||i()}));s?a(this.store.get(t,o)||void 0):a()}isUpdated(e,t){return!e||!t||t.version>e.version}}},2453:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.createStreamListeners=t.createPatchListener=t.createPutListener=void 0;const i=r(5553);t.createPutListener=(e,t,r=(()=>{}))=>({deserializeData:i.deserializeAll,processJson:(i,{flags:o})=>n(void 0,void 0,void 0,(function*(){const n={flags:o,version:0};null==t||t.debug("Initializing all data"),e.init(i,n,r)}))}),t.createPatchListener=(e,t,r=(()=>{}))=>({deserializeData:i.deserializePatch,processJson:(i,o)=>n(void 0,void 0,void 0,(function*(){0!==(null==o?void 0:o.length)?null==o||o.forEach((n=>{null==t||t.debug(`Updating ${n.data.key} in ${n.kind.namespace}`),e.upsert(i,n.kind,n.data,r)})):null==r||r()}))}),t.createStreamListeners=(e,r,n)=>{const i=new Map;return i.set("put",(0,t.createPutListener)(e,r,null==n?void 0:n.put)),i.set("patch",(0,t.createPatchListener)(e,r,null==n?void 0:n.patch)),i}},2678:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(2453),t),i(r(5219),t)},2791:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.DataSyncModeEnum=void 0,function(e){e.POLLING="polling",e.STREAMING="streaming"}(r||(t.DataSyncModeEnum=r={}))},1246:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5444:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5384:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NullDataSynchronizer=void 0,t.NullDataSynchronizer=class{close(){}start(){}stop(){}identify(){}}},3043:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(7428),i=r(1766),o=r(4012);t.default=class{constructor(e,t,r,n,i){this.requestor=t,this.getStoreTimestamp=r,this.listeners=n,this.errorHandler=i,this.stopped=!1,this.logger=e.logger,this.pollingInterval=e.pollingInterval,this.user=e.user}poll(){var e;if(this.stopped)return;const t=Date.now();null===(e=this.logger)||void 0===e||e.debug("Polling for feature flag and segments updates"),this.requestor.requestData(this.getStoreTimestamp(),this.user,((e,r)=>{var s,a,l,u,c,d,h;const v=Date.now()-t,f=Math.max(this.pollingInterval-v,0);if(null===(s=this.logger)||void 0===s||s.debug("Elapsed: %d ms, sleeping for %d ms",v,f),e){const{status:t}=e;if(t&&!(0,n.isHttpRecoverable)(t)){const r=(0,o.httpErrorMessage)(e,"polling request");return null===(a=this.logger)||void 0===a||a.error(r),void(null===(l=this.errorHandler)||void 0===l||l.call(this,new n.PollingError(r,t)))}null===(u=this.logger)||void 0===u||u.warn((0,o.httpErrorMessage)(e,"polling request","will retry"))}else{let e=[],t=null===(c=this.user)||void 0===c?void 0:c.keyId,n=this.listeners.get("patch");if(r){const o=JSON.parse(r);if("data-sync"===o.messageType){switch(o.data.eventType){case i.StreamResponseEventType.patch:n=this.listeners.get("patch");break;case i.StreamResponseEventType.full:n=this.listeners.get("put")}({featureFlags:e,userKeyId:t}=o.data)}}const o=null===(d=null==n?void 0:n.deserializeData)||void 0===d?void 0:d.call(n,e);null===(h=null==n?void 0:n.processJson)||void 0===h||h.call(n,t,o)}this.timeoutHandle=setTimeout((()=>{this.poll()}),f)}))}identify(e){this.user=Object.assign({},e)}close(){this.stop()}start(){this.poll()}stop(){this.timeoutHandle&&(clearTimeout(this.timeoutHandle),this.timeoutHandle=void 0),this.stopped=!0}}},216:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=r(7428),o=r(4012);t.default=class{constructor(e,t,r,n){this.requests=n,this.headers=(0,o.defaultHeaders)(e,r),this.uri=t.pollingUri}request(e,t){return n(this,void 0,void 0,(function*(){const r=yield this.requests.fetch(e,t),n=yield r.text();return{res:r,body:n}}))}requestData(e,t,r){return n(this,void 0,void 0,(function*(){const n={method:"POST",headers:this.headers,body:JSON.stringify(t)};try{const{res:t,body:o}=yield this.request(`${this.uri}?timestamp=${null!=e?e:0}`,n);if(200!==t.status&&304!==t.status){const e=new i.StreamingError(`Unexpected status code: ${t.status}`,t.status);return r(e,void 0)}return r(void 0,304===t.status?null:o)}catch(e){return r(e,void 0)}}))}}},4813:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e,t,r,n,i,o,s){this.getStoreTimestamp=i,this.listeners=o;const{logger:a,streamingUri:l}=r;this.logger=a,this.socket=n,this.socket.config({sdkKey:e,streamingUri:l,pingInterval:s,user:t,logger:a,getStoreTimestamp:i}),this.listeners.forEach((({deserializeData:e,processJson:t},r)=>{var n;null===(n=this.socket)||void 0===n||n.addListener(r,(n=>{var i;if(null===(i=this.logger)||void 0===i||i.debug(`Received ${r} event`),null==n?void 0:n.data){const{featureFlags:r,userKeyId:i}=n.data,o=e(r);t(i,o)}}))}))}identify(e){var t;null===(t=this.socket)||void 0===t||t.identify(e)}start(){var e;this.logConnectionStarted(),null===(e=this.socket)||void 0===e||e.connect()}logConnectionStarted(){var e;this.connectionAttemptStartTime=Date.now(),null===(e=this.logger)||void 0===e||e.info(`Stream connection attempt StartTime ${this.connectionAttemptStartTime}`)}close(){this.stop()}stop(){var e;null===(e=this.socket)||void 0===e||e.close(),this.socket=void 0}}},1958:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(2791),t),i(r(1246),t),i(r(5444),t),i(r(5384),t),i(r(3043),t),i(r(216),t),i(r(1766),t),i(r(8469),t),i(r(4813),t)},1766:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.StreamResponseEventType=void 0,function(e){e.full="full",e.patch="patch"}(r||(t.StreamResponseEventType=r={}))},8469:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateConnectionToken=void 0;const r={0:"Q",1:"B",2:"W",3:"S",4:"P",5:"H",6:"D",7:"X",8:"Z",9:"U"};function n(e,t){var n="000000000000"+e;return n.slice(n.length-t).split("").map((e=>r[e])).join("")}t.generateConnectionToken=function(e){e=e.replace(/=*$/,"");const t=Date.now(),r=n(t,t.toString().length),i=Math.max(Math.floor(Math.random()*e.length),2);return`${n(i,3)}${n(r.length,2)}${e.slice(0,i)}${r}${e.slice(i)}`}},7428:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isHttpRecoverable=t.ClientError=t.UnexpectedResponseError=t.StreamingError=t.PollingError=void 0;class r extends Error{constructor(e,t){super(e),this.status=t,this.name="FbPollingError"}}t.PollingError=r;class n extends Error{constructor(e,t){super(e),this.code=t,this.name="FbStreamingError"}}t.StreamingError=n;class i extends Error{constructor(e){super(e),this.name="FbUnexpectedResponseError"}}t.UnexpectedResponseError=i;class o extends Error{constructor(e){super(e),this.name="FbClientError"}}t.ClientError=o,t.isHttpRecoverable=function(e){return!(e>=400&&e<500)||400===e||408===e||429===e}},4241:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(9435),i=r(4111);class o{constructor(e,t,r){this.kind=e,this.value=t,this.reason=r}static flagNotFound(e){return new o(n.ReasonKinds.FlagNotFound,null,`flag not found: ${e}`)}static matched(e){return new o(n.ReasonKinds.Match,e,"target match")}toEvalEvent(e){var t,r,o;if(this.kind!==n.ReasonKinds.Match)return null;const s=null===(t=this.value)||void 0===t?void 0:t.variations.find((e=>{var t;return e.value===(null===(t=this.value)||void 0===t?void 0:t.variation)}));return new i.EvalEvent(e,null===(r=this.value)||void 0===r?void 0:r.id,s,null===(o=this.value)||void 0===o?void 0:o.sendToExperiment)}}t.default=o},942:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(4241)),o=n(r(1410));t.default=class{constructor(e){this.store=e}evaluate(e){const t=this.store.get(o.default.Flags,e);return t?i.default.matched(t):i.default.flagNotFound(e)}}},764:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9435:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ReasonKinds=void 0,function(e){e.ClientNotReady="ClientNotReady",e.Match="Match",e.WrongType="WrongType",e.FlagNotFound="FlagNotFound",e.Error="Error"}(r||(t.ReasonKinds=r={}))},904:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.VariationDataType=void 0,function(e){e.string="string",e.boolean="boolean",e.number="number",e.json="json",e.empty=""}(r||(t.VariationDataType=r={}))},5302:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(904),t)},2311:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(5302),t),i(r(4241),t),i(r(942),t),i(r(764),t),i(r(9435),t)},5726:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultEventProcessor=void 0;const i=r(3714),o=r(4111),s=r(5772),a=r(4212);t.DefaultEventProcessor=class{constructor(e){this.closed=!1;const{logger:t,flushInterval:r,maxEventsInQueue:n}=e;this.logger=t,this.flushInterval=r,this.eventQueue=new a.DefaultEventQueue(n,this.logger),this.eventDispatcher=new i.EventDispatcher(e,this.eventQueue),this.flushLoop()}flushLoop(){this.closed||setTimeout((()=>n(this,void 0,void 0,(function*(){try{yield this.flush()}catch(e){this.logger.error("Unexpected error while flushing events in event processor.",e)}this.flushLoop()}))),this.flushInterval)}flush(){const e=new o.FlushEvent;return this.record(e),e.waitForCompletion()}close(){return n(this,void 0,void 0,(function*(){if(this.closed)return;const e=new o.ShutdownEvent;this.record(e);try{yield e.waitForCompletion()}catch(e){this.logger.error("Event processor shutdown but not complete.")}this.eventQueue.close(),this.closed=!0}))}record(e){return!((0,s.isNullOrUndefined)(e)||!this.eventQueue.addEvent(e)&&(e instanceof o.FlushEvent&&e.complete(),1))}}},4212:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultEventQueue=void 0,t.DefaultEventQueue=class{constructor(e,t){this.capacity=e,this.logger=t,this.closed=!1,this.events=[]}addEvent(e){return!this.closed&&(this.events.length>=this.capacity?(this.logger.warn("Events are being produced faster than they can be processed. We shouldn't see this."),!1):(this.events.push(e),!0))}clear(){this.events=[]}shift(){return this.events.shift()}close(){this.closed=!0}get eventsSnapshot(){return[...this.events]}get length(){return this.events.length}get isEmpty(){return 0===this.length}}},4090:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultEventSender=void 0;const o=r(3516),s=r(4012),a=r(7428),l=i(r(601));t.DefaultEventSender=class{constructor(e){const{sdkKey:t,eventsUri:r,platform:n}=e,{info:i,requests:o}=n;this.defaultHeaders=(0,s.defaultHeaders)(t,i),this.eventsUri=r,this.requests=o}send(e,t){return n(this,void 0,void 0,(function*(){const r={status:o.DeliveryStatus.Succeeded},n=Object.assign(Object.assign({},this.defaultHeaders),{"content-type":"application/json"});let i;try{const{status:t}=yield this.requests.fetch(this.eventsUri,{headers:n,body:e,method:"POST"});if(t>=200&&t<=299)return r;if(i=new a.UnexpectedResponseError((0,s.httpErrorMessage)({status:t,message:"some events were dropped"},"event posting")),!(0,a.isHttpRecoverable)(t))return r.status=o.DeliveryStatus.FailedAndMustShutDown,r.error=i,r}catch(e){i=e}return i&&!t?(r.status=o.DeliveryStatus.Failed,r.error=i,r):(yield(0,l.default)(),this.send(e,!1))}))}}},3125:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultEventSerializer=void 0;const n=r(4111);t.DefaultEventSerializer=class{serialize(e){const t=e.map((e=>e instanceof n.EvalEvent||e instanceof n.MetricEvent?e.toPayload():null)).filter((e=>null!==e));return JSON.stringify(t)}}},3714:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.EventDispatcher=void 0;const o=r(3516),s=r(4212),a=r(4090),l=r(4111),u=r(3125),c=i(r(601));t.EventDispatcher=class{constructor(e,t){this.maxEventPerRequest=50,this.stopped=!1;const{logger:r,maxEventsInQueue:n}=e;this.logger=r,this.buffer=new s.DefaultEventQueue(n,this.logger),this.sender=new a.DefaultEventSender(e),this.serializer=new u.DefaultEventSerializer,this.dispatchLoop(t).then()}dispatchLoop(e){return n(this,void 0,void 0,(function*(){this.logger.debug("Start dispatch loop.");let t=!0;for(;t;)try{const r=e.shift();if(void 0===r){yield(0,c.default)(1e3);continue}r instanceof l.PayloadEvent?this.addEventToBuffer(r):r instanceof l.FlushEvent?yield this.triggerFlush(r):r instanceof l.ShutdownEvent&&(yield this.triggerFlush(r),this.stopped=!0,t=!1)}catch(e){this.logger.error("Unexpected error in event dispatcher.",e)}this.logger.debug("Finish dispatch loop.")}))}addEventToBuffer(e){this.stopped||(this.buffer.addEvent(e)?this.logger.debug("Added event to buffer."):this.logger.warn("Exceeded event queue capacity, event will be dropped. Increase capacity to avoid dropping events."))}triggerFlush(e){return n(this,void 0,void 0,(function*(){if(this.stopped)return void e.complete();if(this.buffer.isEmpty)return e.complete(),void this.logger.debug("Flush empty buffer.");const t=this.buffer.eventsSnapshot;this.buffer.clear();try{yield this.flushEvents(t),this.logger.debug(`${t.length} events has been flushed.`)}catch(e){this.logger.warn("Exception happened when flushing events",e)}e.complete()}))}flushEvents(e){return n(this,void 0,void 0,(function*(){const t=(e=this.getUniqueEvents(e)).length;for(let r=0;r<t;r+=this.maxEventPerRequest){const n=Math.min(this.maxEventPerRequest,t-r),i=e.slice(r,r+n),s=this.serializer.serialize(i),{status:a}=yield this.sender.send(s,!0);a===o.DeliveryStatus.FailedAndMustShutDown&&(this.stopped=!0)}}))}getUniqueEvents(e){const t=[],r=[];for(const n of e)r.includes(n.hash)||(t.push(n),r.push(n.hash));return t}}},5055:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2615:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5263:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3516:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.DeliveryStatus=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed",e[e.FailedAndMustShutDown=2]="FailedAndMustShutDown"}(r||(t.DeliveryStatus=r={}))},1039:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NullEventProcessor=void 0,t.NullEventProcessor=class{flush(){return Promise.resolve()}close(){return Promise.resolve()}record(e){return!1}}},4111:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EvalEvent=t.MetricEvent=t.PayloadEvent=t.ShutdownEvent=t.FlushEvent=t.AsyncEvent=void 0;class r{get hash(){return this.timestamp.toString()}constructor(){this.timestamp=(new Date).getTime(),this.isCompletedPromise=new Promise((e=>{this.resolveFn=e}))}waitForCompletion(){return this.isCompletedPromise}complete(){var e;null===(e=this.resolveFn)||void 0===e||e.call(this,this)}}t.AsyncEvent=r,t.FlushEvent=class extends r{},t.ShutdownEvent=class extends r{};class n{constructor(){this.timestamp=(new Date).getTime()}get hash(){return this.timestamp.toString()}toPayload(){}}t.PayloadEvent=n,t.MetricEvent=class extends n{constructor(e,t,r,n){super(),this.user=e,this.eventName=t,this.appType=r,this.metricValue=n}userPayload(){return{keyId:this.user.keyId,name:this.user.name,customizedProperties:this.user.customizedProperties}}toPayload(){return{user:this.userPayload(),metrics:[{route:"index/metric",timestamp:this.timestamp,numericValue:this.metricValue,appType:this.appType,eventName:this.eventName,type:"CustomEvent"}]}}get hash(){const e=this.toPayload(),t={user:e.user,metrics:e.metrics.map((e=>Object.assign(Object.assign({},e),{timestamp:void 0})))};return JSON.stringify(t)}},t.EvalEvent=class extends n{constructor(e,t,r,n){super(),this.user=e,this.flagKey=t,this.variation=r,this.sendToExperiment=n}userPayload(){return{keyId:this.user.keyId,name:this.user.name,customizedProperties:this.user.customizedProperties}}toPayload(){return{user:this.userPayload(),variations:[{featureFlagKey:this.flagKey,sendToExperiment:this.sendToExperiment,timestamp:this.timestamp,variation:this.variation}]}}get hash(){const e=this.toPayload(),t={user:e.user,variations:e.variations.map((e=>Object.assign(Object.assign({},e),{timestamp:void 0})))};return JSON.stringify(t)}}},1588:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(5726),t),i(r(4212),t),i(r(4090),t),i(r(3125),t),i(r(4111),t),i(r(3714),t),i(r(5055),t),i(r(2615),t),i(r(5263),t),i(r(3516),t),i(r(1039),t)},1726:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(8559),t),i(r(2678),t),i(r(2311),t),i(r(1588),t),i(r(4076),t),i(r(9181),t),i(r(3005),t),i(r(6731),t),i(r(1958),t),i(r(7312),t),i(r(3630),t),i(r(9677),t),i(r(1443),t),i(r(7428),t),i(r(4309),t),i(r(3529),t),i(r(6267),t),i(r(649),t),i(r(5615),t),i(r(2408),t)},9007:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BasicLogger=void 0;const i=n(r(5818)),o={debug:0,info:1,warn:2,error:3,none:4},s=["debug","info","warn","error","none"];class a{static get(){return new a({})}constructor(e){var t,r,n;this.logLevel=null!==(r=o[null!==(t=e.level)&&void 0!==t?t:"info"])&&void 0!==r?r:o.info,this.name=null!==(n=e.name)&&void 0!==n?n:"FeatBit",this.destination=e.destination,this.formatter=e.formatter}tryFormat(...e){var t;try{return this.formatter?null===(t=this.formatter)||void 0===t?void 0:t.call(this,...e):(0,i.default)(...e)}catch(t){return(0,i.default)(...e)}}tryWrite(e){try{this.destination(e)}catch(t){console.error(e)}}log(e,t){if(e>=this.logLevel){const r=`${s[e]}: [${this.name}]`;try{this.destination?this.tryWrite(`${r} ${this.tryFormat(...t)}`):console.error(...t)}catch(e){console.error(...t)}}}error(...e){this.log(o.error,e)}warn(...e){this.log(o.warn,e)}info(...e){this.log(o.info,e)}debug(...e){this.log(o.debug,e)}}t.BasicLogger=a},2223:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},710:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7285:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},4208:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SafeLogger=void 0;const n=r(4962),i={error:n.TypeValidators.Function,warn:n.TypeValidators.Function,info:n.TypeValidators.Function,debug:n.TypeValidators.Function};t.SafeLogger=class{constructor(e,t){Object.entries(i).forEach((([t,r])=>{if(!r.is(e[t]))throw new Error(`Provided logger instance must support logger.${t}(...) method`)})),this.logger=e,this.fallback=t}log(e,t){try{this.logger[e](...t)}catch(r){this.fallback[e](...t)}}error(...e){this.log("error",e)}warn(...e){this.log("warn",e)}info(...e){this.log("info",e)}debug(...e){this.log("debug",e)}}},5818:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(4962);function i(e){if("string"==typeof e)return e;if(void 0===e)return"undefined";if(null===e)return"null";if(Object.prototype.hasOwnProperty.call(e,"toString"))try{return e.toString()}catch(e){}if("bigint"==typeof e)return`${e}n`;try{return JSON.stringify(e)}catch(e){return e instanceof TypeError&&e.message.indexOf("circular")>=0?"[Circular]":"[Not Stringifiable]"}}const o={s:e=>i(e),d:e=>function(e){return"symbol"==typeof e?"NaN":"bigint"==typeof e?`${e}n`:String(Number(e))}(e),i:e=>function(e){return"symbol"==typeof e?"NaN":"bigint"==typeof e?`${e}n`:String(parseInt(e,10))}(e),f:e=>function(e){return"symbol"==typeof e?"NaN":String(parseFloat(e))}(e),j:e=>i(e),o:e=>i(e),O:e=>i(e),c:()=>""};t.default=function(...e){var t;const r=e.shift();if(n.TypeValidators.String.is(r)){let n="",s=0;for(;s<r.length;){const i=r.charAt(s);if("%"===i){if(s+1<r.length){const i=r.charAt(s+1);if(i in o&&e.length){const r=e.shift();n+=null===(t=o[i])||void 0===t?void 0:t.call(o,r)}else n+="%"===i?"%":`%${i}`;s+=2}}else n+=i,s+=1}return e.length&&(n.length&&(n+=" "),n+=e.map(i).join(" ")),n}return e.map(i).join(" ")}},4076:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(9007),t),i(r(5818),t),i(r(2223),t),i(r(710),t),i(r(7285),t),i(r(4208),t)},5778:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e,t,r){this.sdkKey=e,this.platform=r,this.logger=t.logger,this.offline=t.offline,this.flushInterval=t.flushInterval,this.maxEventsInQueue=t.maxEventsInQueue,this.streamingUri=t.streamingUri,this.pollingUri=t.pollingUri,this.eventsUri=t.eventsUri}}},4623:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6497:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},8037:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},822:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1475:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{static optionBelowMinimum(e,t,r){return`Config option "${e}" had invalid value of ${t}, using minimum of ${r} instead`}static unknownOption(e){return`Ignoring unknown config option "${e}"`}static wrongOptionType(e,t,r){return`Config option "${e}" should be of type ${t}, got ${r}, using default value`}static wrongOptionTypeBoolean(e,t){return`Config option "${e}" should be a boolean, got ${t}, converting to boolean`}static partialEndpoint(e){return`You have set custom uris without specifying the ${e} URI; connections may not work properly`}static mandatory(e){return`${e} is mandatory`}static invalidOptionValue(e){return`Invalid option value: ${e}`}static missingKeyInBootstrapValue(e){return`Missing key "${e}" in bootstrap value`}}},1819:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UserBuilder=void 0,t.UserBuilder=class{constructor(e){this._keyId="",this._name="",this._custom=[],this._keyId=e}name(e){return this._name=e,this}custom(e,t){var r;return null===(r=this._custom)||void 0===r||r.push({name:e,value:`${t}`}),this}build(){return{name:this._name,keyId:this._keyId,customizedProperties:this._custom}}}},4962:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TypeValidators=t.KindValidator=t.DateValidator=t.UserValidator=t.BootstrapValidator=t.NullableBoolean=t.Function=t.StringMatchingRegex=t.NumberWithMinimum=t.TypeArray=t.Type=t.FactoryOrInstance=void 0;const i=n(r(1475));class o{is(e){if(Array.isArray(e))return!1;const t=typeof e;return"function"===t||"object"===t}getType(){return"factory method or object"}}t.FactoryOrInstance=o;class s{constructor(e,t){this.typeName=e,this.typeOf=typeof t}is(e){return!Array.isArray(e)&&typeof e===this.typeOf}getType(){return this.typeName}}t.Type=s;class a{constructor(e,t){this.typeName=e,this.typeOf=typeof t}is(e){return!!Array.isArray(e)&&(!(e.length>0)||e.every((e=>typeof e===this.typeOf)))}getType(){return this.typeName}}t.TypeArray=a;class l extends s{constructor(e){super(`number with minimum value of ${e}`,0),this.min=e}is(e){return typeof e===this.typeOf&&e>=this.min}}t.NumberWithMinimum=l;class u extends s{constructor(e){super(`string matching ${e}`,""),this.expression=e}is(e){return!!e.match(this.expression)}}t.StringMatchingRegex=u;class c{is(e){return"function"==typeof e}getType(){return"function"}}t.Function=c;class d{is(e){return"boolean"==typeof e||null==e}getType(){return"boolean | undefined | null"}}t.NullableBoolean=d,t.BootstrapValidator=class{constructor(){this.messages=[]}is(e){if("object"!=typeof e||null===e)return this.messages.push(i.default.invalidOptionValue("bootstrap")),!1;try{const t=e;for(let e of t){["id","variation"].every((t=>Object.keys(e).includes(t)));const t=Object.keys(e);if(t.includes("id")&&this.messages.push(i.default.missingKeyInBootstrapValue("id")),t.includes("variation")&&this.messages.push(i.default.missingKeyInBootstrapValue("variation")),this.messages.length>0)return!1}}catch(t){return this.messages.push(i.default.wrongOptionType("bootstrap",this.getType(),typeof e)),!1}return!0}getType(){return"IFlagBase[]"}},t.UserValidator=class{constructor(){this.messages=[]}is(e){if("object"!=typeof e||null===e)return this.messages.push(i.default.mandatory("user")),!1;const t=e;return"string"!=typeof t.keyId||""===t.keyId.trim()?(this.messages.push(i.default.mandatory("user.keyId")),!1):"string"==typeof t.name&&""!==t.name.trim()||(this.messages.push(i.default.mandatory("user.name")),!1)}getType(){return"user"}};const h=/^\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d(\.\d\d*)?(Z|[-+]\d\d(:\d\d)?)/;class v{is(e){return"number"==typeof e||"string"==typeof e&&h.test(e)}getType(){return"date"}}t.DateValidator=v;class f extends u{constructor(){super(/^(\w|\.|-)+$/)}is(e){return super.is(e)&&"kind"!==e}}t.KindValidator=f;class p{static createTypeArray(e,t){return new a(e,t)}static numberWithMin(e){return new l(e)}static stringMatchingRegex(e){return new u(e)}}t.TypeValidators=p,p.String=new s("string",""),p.Number=new s("number",0),p.ObjectOrFactory=new o,p.Object=new s("object",{}),p.StringArray=new a("string[]",""),p.Boolean=new s("boolean",!0),p.User=new s("object",{}),p.Bootstrap=new s("object",{}),p.Function=new c,p.Date=new v,p.Kind=new f,p.NullableBoolean=new d},9181:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(5778),t),i(r(4623),t),i(r(6497),t),i(r(8037),t),i(r(822),t),i(r(1475),t),i(r(1819),t),i(r(4962),t)},8750:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9417:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7534:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7807:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(7199);t.default=class{get appType(){return"Browser-Client-SDK"}platformData(){return{os:{},name:"Browser",additional:{}}}sdkData(){return{name:n.name,version:n.version,userAgentBase:this.appType}}}},7018:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(7807)),o=r(911),s=n(r(5541));t.default=class{constructor(e){this.info=new i.default,this.requests=new o.BrowserRequests,this.webSocket=new s.default}}},911:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserRequests=void 0,t.BrowserRequests=class{fetch(e,t={}){return fetch(e,t)}}},5541:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(7167),i=r(7572),o=r(8469),s=r(1766),a=[1e3,3e3,5e3,7e3,11e3,13e3,3e4,6e4];t.default=(0,n.Emits)(class{constructor(){this.retryCounter=0,this.closed=!1,this._config={},this.emitter=new i.EventEmitter}identify(e){this._config.user=e,this.doDataSync()}connect(){var e,t,r,n;let i=this;const a=Date.now(),l=this._config.streamingUri.replace(/^http/,"ws")+`?type=client&token=${(0,o.generateConnectionToken)(this._config.sdkKey)}`;this.ws=new WebSocket(l),null===(e=i.ws)||void 0===e||e.addEventListener("open",(function(e){i._config.logger.info(`WebSocket connection succeeded, connection time: ${Date.now()-a} ms`),i.doDataSync(),i.sendPingMessage()})),null===(t=i.ws)||void 0===t||t.addEventListener("close",(function(e){i._config.logger.warn("WebSocket closed"),4003!==e.code&&i.reconnect()})),null===(r=i.ws)||void 0===r||r.addEventListener("error",(function(e){i._config.logger.debug("error")})),null===(n=i.ws)||void 0===n||n.addEventListener("message",(function(e){const t=JSON.parse(e.data);if("data-sync"===t.messageType)switch(t.data.eventType){case s.StreamResponseEventType.patch:i.emitter.emit("patch",t);break;case s.StreamResponseEventType.full:i.emitter.emit("put",t)}}))}close(){var e;this.closed=!0,null===(e=this.ws)||void 0===e||e.close(4003,"The client is closed by user"),this.ws=void 0}config(e){e.emitter&&(this.emitter=e.emitter),this._config=Object.assign({},e)}sendPingMessage(){const e={messageType:"ping",data:null};setTimeout((()=>{var t;try{(null===(t=this.ws)||void 0===t?void 0:t.readyState)===WebSocket.OPEN?(this._config.logger.debug("sending ping"),this.ws.send(JSON.stringify(e)),this.sendPingMessage()):this._config.logger.debug(`socket closed at ${new Date}`)}catch(e){this._config.logger.debug(e)}}),this._config.pingInterval)}doDataSync(){var e,t;const r={messageType:"data-sync",data:{timestamp:this._config.getStoreTimestamp(),user:this._config.user}};try{(null===(e=this.ws)||void 0===e?void 0:e.readyState)===WebSocket.OPEN?(this._config.logger.debug("requesting data"),null===(t=this.ws)||void 0===t||t.send(JSON.stringify(r))):this._config.logger.error("not requesting data because socket not open")}catch(e){this._config.logger.debug(e)}}reconnect(){if(!this.closed){this.ws=void 0;const e=a[Math.min(this.retryCounter++,a.length-1)];this._config.logger.info(`The client will try to reconnect in ${e} milliseconds.`),setTimeout((()=>{this._config.logger.info(`The client is trying to reconnect, flag evaluation results may be stale until reconnected, waited for: ${e} milliseconds`),this.connect()}),e)}}})},7106:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(2408),o=r(9007),s=r(7572),a=r(4208),l=r(7167),u=n(r(7018)),c=n(r(9095));class d extends i.FbClientCore{constructor(e,t=void 0){const r=new o.BasicLogger({level:"none",destination:console.log}),n=e.logger?new a.SafeLogger(e.logger,r):r,i=new s.EventEmitter(n);let{store:l}=e;l||(l=new c.default(e)),super(Object.assign(Object.assign({},e),{logger:n,store:l}),null!=t?t:new u.default(Object.assign(Object.assign({},e),{logger:n})),{onError:e=>{i.listenerCount("error")&&i.emit("error",e)},onFailed:e=>{i.emit("failed",e)},onReady:()=>{i.emit("ready")},onUpdate:e=>{i.emit("update",[e]),e.forEach((e=>i.emit(`update:${e}`,e)))},hasEventListeners:()=>i.eventNames().some((e=>"update"===e||"string"==typeof e&&e.startsWith("update:")))}),this.emitter=i}}t.default=(0,l.Emits)(d)},9095:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=r(2447),o=r(1619),s=r(9487);class a extends o.BaseStore{constructor(e){super(),this.logger=e.logger}close(){}get description(){return"local-storage-store"}saveUser(){return n(this,void 0,void 0,(function*(){localStorage.setItem(i.CurrentUserStorageKey,(0,s.serializeUser)(this._user))}))}dumpStoreToStorage(){return n(this,void 0,void 0,(function*(){const e=`${i.StoreStorageKey}-${this._user.keyId}`;localStorage.setItem(e,JSON.stringify(this.store))}))}loadStoreFromStorage(){return n(this,void 0,void 0,(function*(){const e=`${i.StoreStorageKey}-${this._user.keyId}`,t=localStorage.getItem(e);let r=null;try{t&&t.trim().length>0&&(r=JSON.parse(t))}catch(t){this.logger.error(`error while loading local data store: ${e}`,t)}this.store=r||{flags:{},version:0}}))}}t.default=a},3005:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserWebSocket=void 0,i(r(8750),t),i(r(9417),t),i(r(6),t),i(r(7534),t),i(r(7386),t),i(r(911),t);const s=o(r(5541));t.BrowserWebSocket=s.default},7386:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1619:function(e,t){var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseStore=void 0,t.BaseStore=class{constructor(){this.store={},this.initCalled=!1,this._user={}}identify(e){return r(this,void 0,void 0,(function*(){this._user=Object.assign({},e),yield this.saveUser(),yield this.loadStoreFromStorage()}))}get user(){return this._user}addItem(e,t,n){return r(this,void 0,void 0,(function*(){let r=this.store[e.namespace];if(r||(r={},this.store[e.namespace]=r),Object.hasOwnProperty.call(r,t)){const e=r[t];(!e||e.version<n.version)&&(r[t]=n)}else r[t]=n;n.version>this.store.version&&(this.store.version=n.version),yield this.dumpStoreToStorage()}))}get(e,t){const r=this.store[e.namespace];if(r&&Object.prototype.hasOwnProperty.call(r,t)){const e=r[t];if(e)return e}return null}all(e){var t;const r={},n=null!==(t=this.store[e.namespace])&&void 0!==t?t:{};return Object.entries(n).forEach((([e,t])=>{t&&(r[e]=t)})),[r,this.store.version]}init(e){return r(this,void 0,void 0,(function*(){this.store=e,Object.keys(e).map((t=>{Object.entries(e[t]).forEach((([e,t])=>{const r=t;r.version>this.store.version&&(this.store.version=r.version)}))})),yield this.dumpStoreToStorage(),this.initCalled=!0}))}upsert(e,t){return r(this,void 0,void 0,(function*(){yield this.addItem(e,t.key,t)}))}initialized(){return this.initCalled}close(){}get version(){return this.store.version}get description(){return""}saveUser(){return r(this,void 0,void 0,(function*(){}))}loadStoreFromStorage(){return r(this,void 0,void 0,(function*(){}))}dumpStoreToStorage(){return r(this,void 0,void 0,(function*(){}))}}},1410:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class r{}r.Flags={namespace:"flags"},t.default=r},7739:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7769:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=r(2447),o=r(1619);class s extends o.BaseStore{constructor(){super(),this.allStores={}}close(){}get description(){return"in-memory-store"}saveUser(){return n(this,void 0,void 0,(function*(){}))}dumpStoreToStorage(){return n(this,void 0,void 0,(function*(){const e=`${i.StoreStorageKey}-${this._user.keyId}`;this.allStores[e]=Object.assign({},this.store)}))}loadStoreFromStorage(){var e;return n(this,void 0,void 0,(function*(){const t=`${i.StoreStorageKey}-${this._user.keyId}`;this.store=null!==(e=this.allStores[t])&&void 0!==e?e:{flags:{},version:0}}))}}t.default=s},6731:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(1410),t),i(r(7739),t),i(r(7769),t),i(r(5553),t),i(r(2447),t),i(r(1619),t)},5553:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deserializePatch=t.deserializeAll=void 0;const i=n(r(1410));t.deserializeAll=function(e){const t={[i.default.Flags.namespace]:{}};return(null==e?void 0:e.length)&&(t[i.default.Flags.namespace]=e.reduce(((e,t)=>(e[t.id]=Object.assign(Object.assign({},t),{version:t.timestamp||0,key:t.id,variations:t.variationOptions}),e)),{})),t},t.deserializePatch=function(e){return[...(null==e?void 0:e.map((e=>({data:Object.assign(Object.assign({},e),{version:e.timestamp,key:e.id,variations:e.variationOptions}),kind:i.default.Flags}))))||[]]}},2447:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CurrentUserStorageKey=t.StoreStorageKey=void 0,t.StoreStorageKey="fb-datastore",t.CurrentUserStorageKey="fb-user"},7167:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Emits=void 0,t.Emits=function(e){return class extends e{on(e,t,r){return this.emitter.on(e,t,r),this}addListener(e,t,r){return this.emitter.addListener(e,t,r),this}once(e,t,r){return this.emitter.once(e,t,r),this}removeListener(e,t,r){return this.emitter.removeListener(e,t,r),this}off(e,t,r){return this.emitter.off(e,t,r),this}removeAllListeners(e){return this.emitter.removeAllListeners(e),this}listeners(e){return this.emitter.listeners(e)}emit(e,...t){return this.emitter.emit(e,t),this}listenerCount(e){return this.emitter.listenerCount(e)}prependListener(e,t,r){return this.emitter.prependListener(e,t,r),this}prependOnceListener(e,t,r){return this.emitter.prependOnceListener(e,t,r),this}eventNames(){return this.emitter.eventNames()}maybeReportError(e){return this.emitter.maybeReportError(e),this}}}},7572:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventEmitter=void 0,t.EventEmitter=class{constructor(e){this.logger=e,this.events={}}listeningTo(e){return!!this.events[e]}on(e,t,r){return this.events[e]=this.events[e]||[],this.events[e]=this.events[e].concat({handler:t,context:r}),this}addListener(e,t,r){return this.on(e,t,r)}once(e,t,r){const n=(...i)=>{this.off(e,n,r),t.apply(r,i)};return this.on(e,n,r)}off(e,t,r){if(!this.events[e])return this;for(let n=0;n<this.events[e].length;n++)this.events[e][n].handler===t&&this.events[e][n].context===r&&(this.events[e]=this.events[e].slice(0,n).concat(this.events[e].slice(n+1)));return this}removeListener(e,t,r){return this.off(e,t,r)}removeAllListeners(e){return e?delete this.events[e]:this.events={},this}listeners(e){return this.events[e]?this.events[e].map((e=>e.handler)):[]}emit(e,...t){if(!this.events[e])return this;const r=[...this.events[e]];for(let e=0;e<r.length;e++)r[e].handler.apply(r[e].context,Array.prototype.slice.call(arguments,1));return this}listenerCount(e){return this.events[e]?this.events[e].length:0}prependListener(e,t,r){return this.events[e]=this.events[e]||[],this.events[e]=[{handler:t,context:r},...this.events[e]],this}prependOnceListener(e,t,r){const n=(...i)=>{this.off(e,n,r),t.apply(r,i)};return this.prependListener(e,n,r)}eventNames(){return Object.keys(this.events)}maybeReportError(e){var t;return e?(this.listeningTo("error")?this.emit("error",e):null===(t=this.logger)||void 0===t||t.error(e),this):this}}},7378:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ValueConverters=void 0;class r{static bool(e){return"TRUE"===(null==e?void 0:e.toUpperCase())?r.success(!0):"FALSE"===(null==e?void 0:e.toUpperCase())?r.success(!1):r.error()}static number(e){const t=Number(e);return Number.isNaN(t)?r.error():r.success(t)}static string(e){return r.success(e)}static json(e){try{const t=JSON.parse(e);return r.success(t)}catch(e){return r.error()}}static success(e){return{isSucceeded:!0,value:e}}static error(){return{isSucceeded:!1}}}t.ValueConverters=r},9640:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},8058:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.canonicalizeUri=void 0,t.canonicalizeUri=function(e){return e.replace(/\/+$/,"")}},3048:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.debounce=void 0,t.debounce=(e,t=5e3)=>{let r;return(...n)=>{clearTimeout(r),r=setTimeout((()=>{e(...n)}),t)}}},4012:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.httpErrorMessage=t.defaultHeaders=void 0,t.defaultHeaders=function(e,t){const{userAgentBase:r,version:n}=t.sdkData();return{"Content-Type":"application/json","User-Agent":`${null!=r?r:t.appType}/${n}`,Authorization:e}},t.httpErrorMessage=function(e,t,r){let n;return n=e.status?`error ${e.status}${401===e.status?" (invalid SDK key)":""}`:`I/O error (${e.message||e})`,`Received ${n} for ${t} - ${null!=r?r:"giving up permanently"}`}},7312:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(5772),t),i(r(601),t),i(r(7378),t),i(r(9640),t),i(r(9487),t),i(r(3048),t)},5772:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isNullOrUndefined=void 0,t.isNullOrUndefined=function(e){return null==e}},9487:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.serializeUser=void 0,t.serializeUser=function(e){var t;return e?`${e.keyId},${e.name},${null===(t=e.customizedProperties)||void 0===t?void 0:t.sort(((e,t)=>{const r=e.name.toLowerCase(),n=t.name.toLowerCase();return r<n?-1:r>n?1:0})).map((e=>`${e.name}:${e.value}`)).join(",")}`:""}},601:function(e,t){var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.default=(e=1e3)=>r(void 0,void 0,void 0,(function*(){return new Promise((t=>{setTimeout(t,e)}))}))},7199:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.name=t.version=void 0,t.version="3.0.5",t.name="@featbit/js-client-sdk"},4878:e=>{var t,r=Object.defineProperty,n=Object.defineProperties,i=Object.getOwnPropertyDescriptor,o=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertyNames,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,c=(e,t,n)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,d=(e,t)=>{for(var r in t||(t={}))l.call(t,r)&&c(e,r,t[r]);if(a)for(var r of a(t))u.call(t,r)&&c(e,r,t[r]);return e},h=(e,t)=>n(e,o(t)),v=(e,t,r)=>new Promise(((n,i)=>{var o=e=>{try{a(r.next(e))}catch(e){i(e)}},s=e=>{try{a(r.throw(e))}catch(e){i(e)}},a=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,s);a((r=r.apply(e,t)).next())})),f={};((e,t)=>{for(var n in t)r(e,n,{get:t[n],enumerable:!0})})(f,{AllProviderEvents:()=>C,ClientProviderEvents:()=>C,DefaultLogger:()=>A,ErrorCode:()=>m,FlagNotFoundError:()=>_,GeneralError:()=>y,GenericEventEmitter:()=>M,InvalidContextError:()=>P,LOG_LEVELS:()=>T,OpenFeatureCommonAPI:()=>V,OpenFeatureError:()=>p,ParseError:()=>b,ProviderNotReadyError:()=>w,ProviderStatus:()=>R,SafeLogger:()=>x,ServerProviderEvents:()=>S,StandardResolutionReasons:()=>g,TargetingKeyMissingError:()=>O,TypeMismatchError:()=>E,isObject:()=>L,isString:()=>D,objectOrUndefined:()=>I,statusMatchesEvent:()=>N,stringOrUndefined:()=>k}),e.exports=(t=f,((e,t,n,o)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of s(t))l.call(e,n)||undefined===n||r(e,n,{get:()=>t[n],enumerable:!(o=i(t,n))||o.enumerable});return e})(r({},"__esModule",{value:!0}),t));var p=class extends Error{constructor(e){super(e),Object.setPrototypeOf(this,p.prototype),this.name="OpenFeatureError"}},g={TARGETING_MATCH:"TARGETING_MATCH",SPLIT:"SPLIT",DISABLED:"DISABLED",DEFAULT:"DEFAULT",UNKNOWN:"UNKNOWN",STATIC:"STATIC",CACHED:"CACHED",ERROR:"ERROR"},m=(e=>(e.PROVIDER_NOT_READY="PROVIDER_NOT_READY",e.FLAG_NOT_FOUND="FLAG_NOT_FOUND",e.PARSE_ERROR="PARSE_ERROR",e.TYPE_MISMATCH="TYPE_MISMATCH",e.TARGETING_KEY_MISSING="TARGETING_KEY_MISSING",e.INVALID_CONTEXT="INVALID_CONTEXT",e.GENERAL="GENERAL",e))(m||{}),y=class extends p{constructor(e){super(e),Object.setPrototypeOf(this,y.prototype),this.name="GeneralError",this.code="GENERAL"}},_=class extends p{constructor(e){super(e),Object.setPrototypeOf(this,_.prototype),this.name="FlagNotFoundError",this.code="FLAG_NOT_FOUND"}},b=class extends p{constructor(e){super(e),Object.setPrototypeOf(this,b.prototype),this.name="ParseError",this.code="PARSE_ERROR"}},E=class extends p{constructor(e){super(e),Object.setPrototypeOf(this,E.prototype),this.name="TypeMismatchError",this.code="TYPE_MISMATCH"}},O=class extends p{constructor(e){super(e),Object.setPrototypeOf(this,O.prototype),this.name="TargetingKeyMissingError",this.code="TARGETING_KEY_MISSING"}},P=class extends p{constructor(e){super(e),Object.setPrototypeOf(this,P.prototype),this.name="InvalidContextError",this.code="INVALID_CONTEXT"}},w=class extends p{constructor(e){super(e),Object.setPrototypeOf(this,w.prototype),this.name="ProviderNotReadyError",this.code="PROVIDER_NOT_READY"}},R=(e=>(e.NOT_READY="NOT_READY",e.READY="READY",e.ERROR="ERROR",e.STALE="STALE",e))(R||{}),S=(e=>(e.Ready="PROVIDER_READY",e.Error="PROVIDER_ERROR",e.ConfigurationChanged="PROVIDER_CONFIGURATION_CHANGED",e.Stale="PROVIDER_STALE",e))(S||{}),C=(e=>(e.Ready="PROVIDER_READY",e.Error="PROVIDER_ERROR",e.ConfigurationChanged="PROVIDER_CONFIGURATION_CHANGED",e.ContextChanged="PROVIDER_CONTEXT_CHANGED",e.Stale="PROVIDER_STALE",e))(C||{}),j={READY:"PROVIDER_READY",ERROR:"PROVIDER_ERROR",STALE:"PROVIDER_STALE",NOT_READY:void 0},N=(e,t)=>!t&&"PROVIDER_READY"===e||j[t]===e,A=class{error(...e){console.error(...e)}warn(...e){console.warn(...e)}info(){}debug(){}},T=["error","warn","info","debug"],x=class{constructor(e){this.fallbackLogger=new A;try{for(const t of T)if(!e[t]||"function"!=typeof e[t])throw new Error(`The provided logger is missing the ${t} method.`);this.logger=e}catch(e){console.error(e),console.error("Falling back to the default logger."),this.logger=this.fallbackLogger}}error(...e){this.log("error",...e)}warn(...e){this.log("warn",...e)}info(...e){this.log("info",...e)}debug(...e){this.log("debug",...e)}log(e,...t){try{this.logger[e](...t)}catch(r){this.fallbackLogger[e](...t)}}},M=class{constructor(e){this.globalLogger=e,this._handlers=new WeakMap}emit(e,t){this.eventEmitter.emit(e,t)}addHandler(e,t){const r=e=>v(this,null,(function*(){yield t(e)}));this._handlers.set(t,r),this.eventEmitter.on(e,r)}removeHandler(e,t){const r=this._handlers.get(t);r&&this.eventEmitter.removeListener(e,r)}removeAllHandlers(e){e?this.eventEmitter.removeAllListeners(e):this.eventEmitter.removeAllListeners()}getHandlers(e){return this.eventEmitter.listeners(e)}setLogger(e){return this._eventLogger=new x(e),this}get _logger(){var e,t;return null!=(t=this._eventLogger)?t:null==(e=this.globalLogger)?void 0:e.call(this)}};function D(e){return"string"==typeof e}function k(e){return D(e)?e:void 0}function L(e){return"object"==typeof e}function I(e){return L(e)?e:void 0}function F(e){return null!=e}var V=class{constructor(e){this._hooks=[],this._context={},this._logger=new A,this._clientEventHandlers=new Map,this._clientProviders=new Map,this._clientEvents=new Map,this._runsOn=e}addHooks(...e){return this._hooks=[...this._hooks,...e],this}getHooks(){return this._hooks}clearHooks(){return this._hooks=[],this}setLogger(e){return this._logger=new x(e),this}get providerMetadata(){return this.getProviderMetadata()}getProviderMetadata(e){return this.getProviderForClient(e).metadata}addHandler(e,t){[...new Map([[void 0,this._defaultProvider]]),...this._clientProviders].forEach((r=>{var n;const i=r[0],o=r[1];if(N(e,r[1].status))try{t({clientName:i,providerName:o.metadata.name})}catch(e){null==(n=this._logger)||n.error("Error running event handler:",e)}})),this._events.addHandler(e,t)}removeHandler(e,t){this._events.removeHandler(e,t)}clearHandlers(){this._events.removeAllHandlers()}getHandlers(e){return this._events.getHandlers(e)}setProviderAndWait(e,t){return v(this,null,(function*(){yield this.setAwaitableProvider(e,t)}))}setProvider(e,t){const r=this.setAwaitableProvider(e,t);return r&&r.catch((()=>{})),this}setAwaitableProvider(e,t){var r,n,i,o,s,a;const l=k(e),u=null!=(r=I(e))?r:I(t);if(!u)return void this._logger.debug("No provider defined, ignoring setProvider call");const c=this.getProviderForClient(l),d=u.metadata.name;if(c===u)return void this._logger.debug("Provider is already set, ignoring setProvider call");if(u.runsOn){if(u.runsOn!==this._runsOn)throw new y(`Provider '${u.metadata.name}' is intended for use on the ${u.runsOn}.`)}else this._logger.debug(`Provider '${u.metadata.name}' has not defined its intended use.`);const h=this.getAssociatedEventEmitters(l);let v;return"function"==typeof u.initialize&&void 0===u.status&&(this._logger||console).warn(`Provider ${d} implements 'initialize' but not 'status'. Please implement 'status'.`),"NOT_READY"===(null==u?void 0:u.status)&&"function"==typeof u.initialize?v=null==(o=null==(i=null==(n=u.initialize)?void 0:n.call(u,this._context))?void 0:i.then((()=>{var e;this.getAssociatedEventEmitters(l).forEach((e=>{null==e||e.emit("PROVIDER_READY",{clientName:l,providerName:d})})),null==(e=this._events)||e.emit("PROVIDER_READY",{clientName:l,providerName:d})})))?void 0:o.catch((e=>{var t;throw this.getAssociatedEventEmitters(l).forEach((t=>{null==t||t.emit("PROVIDER_ERROR",{clientName:l,providerName:d,message:null==e?void 0:e.message})})),null==(t=this._events)||t.emit("PROVIDER_ERROR",{clientName:l,providerName:d,message:null==e?void 0:e.message}),e})):(h.forEach((e=>{null==e||e.emit("PROVIDER_READY",{clientName:l,providerName:d})})),null==(s=this._events)||s.emit("PROVIDER_READY",{clientName:l,providerName:d})),l?this._clientProviders.set(l,u):this._defaultProvider=u,this.transferListeners(c,u,l,h),[...this._clientProviders.values(),this._defaultProvider].includes(c)||null==(a=null==c?void 0:c.onClose)||a.call(c),v}getProviderForClient(e){var t;return e&&null!=(t=this._clientProviders.get(e))?t:this._defaultProvider}buildAndCacheEventEmitterForClient(e){const t=this._clientEvents.get(e);if(t)return t;const r=this._createEventEmitter();this._clientEvents.set(e,r);const n=this.getProviderForClient(e);return Object.values(C).forEach((t=>{var i;return null==(i=n.events)?void 0:i.addHandler(t,(i=>v(this,null,(function*(){r.emit(t,h(d({},i),{clientName:e,providerName:n.metadata.name}))}))))})),r}getUnboundEmitters(){const e=[...this._clientProviders.keys()];return[...[...this._clientEvents.keys()].filter(F).filter((t=>!e.includes(t))).map((e=>this._clientEvents.get(e))),this._clientEvents.get(void 0)].filter(F)}getAssociatedEventEmitters(e){return e?[this.buildAndCacheEventEmitterForClient(e)]:this.getUnboundEmitters()}transferListeners(e,t,r,n){var i;null==(i=this._clientEventHandlers.get(r))||i.forEach((t=>{var r;return null==(r=e.events)?void 0:r.removeHandler(...t)}));const o=Object.values(C).map((e=>[e,i=>v(this,null,(function*(){n.forEach((n=>{null==n||n.emit(e,h(d({},i),{clientName:r,providerName:t.metadata.name}))})),this._events.emit(e,h(d({},i),{clientName:r,providerName:t.metadata.name}))}))]));this._clientEventHandlers.set(r,o),o.forEach((e=>{var r;return null==(r=t.events)?void 0:r.addHandler(...e)}))}close(){return v(this,null,(function*(){var e,t;try{yield null==(t=null==(e=null==this?void 0:this._defaultProvider)?void 0:e.onClose)?void 0:t.call(e)}catch(e){this.handleShutdownError(this._defaultProvider,e)}const r=Array.from(this._clientProviders);yield Promise.all(r.map((e=>v(this,[e],(function*([,e]){var t;try{yield null==(t=e.onClose)?void 0:t.call(e)}catch(t){this.handleShutdownError(e,t)}})))))}))}clearProvidersAndSetDefault(e){return v(this,null,(function*(){try{yield this.close()}catch(e){this._logger.error("Unable to cleanly close providers. Resetting to the default configuration.")}finally{this._clientProviders.clear(),this._defaultProvider=e}}))}handleShutdownError(e,t){this._logger.error(`Error during shutdown of provider ${e.metadata.name}: ${t}`),this._logger.error(null==t?void 0:t.stack)}}},9277:(e,t,r)=>{var n,i,o=Object.create,s=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyDescriptors,c=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,h=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable,p=Reflect.get,g=(e,t,r)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,m=(e,t)=>{for(var r in t||(t={}))v.call(t,r)&&g(e,r,t[r]);if(d)for(var r of d(t))f.call(t,r)&&g(e,r,t[r]);return e},y=(e,t)=>a(e,u(t)),_=(e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let i of c(t))v.call(e,i)||i===r||s(e,i,{get:()=>t[i],enumerable:!(n=l(t,i))||n.enumerable});return e},b=(e,t,r)=>new Promise(((n,i)=>{var o=e=>{try{a(r.next(e))}catch(e){i(e)}},s=e=>{try{a(r.throw(e))}catch(e){i(e)}},a=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,s);a((r=r.apply(e,t)).next())})),E=(n={"../../node_modules/events/events.js"(e,t){var r,n="object"==typeof Reflect?Reflect:null,i=n&&"function"==typeof n.apply?n.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};r=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}t.exports=s,t.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}g(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&g(e,"error",t,{once:!0})}(e,i)}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var a=10;function l(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function c(e,t,r,n){var i,o,s,a;if(l(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=u(e))>0&&s.length>i&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,a=c,console&&console.warn&&console.warn(a)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=d.bind(n);return i.listener=r,n.wrapFn=i,i}function v(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):p(i,i.length)}function f(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function g(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return u(this)},s.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,o=this._events;if(void 0!==o)n=n&&void 0===o.error;else if(!n)return!1;if(n){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[e];if(void 0===l)return!1;if("function"==typeof l)i(l,this,t);else{var u=l.length,c=p(l,u);for(r=0;r<u;++r)i(c[r],this,t)}return!0},s.prototype.addListener=function(e,t){return c(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return c(this,e,t,!0)},s.prototype.once=function(e,t){return l(t),this.on(e,h(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return l(t),this.prependListener(e,h(this,e,t)),this},s.prototype.removeListener=function(e,t){var r,n,i,o,s;if(l(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},s.prototype.listeners=function(e){return v(this,e,!0)},s.prototype.rawListeners=function(e){return v(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},s.prototype.listenerCount=f,s.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}}},function(){return i||(0,n[c(n)[0]])((i={exports:{}}).exports,i),i.exports}),O={};((e,t)=>{for(var r in t)s(e,r,{get:t[r],enumerable:!0})})(O,{InMemoryProvider:()=>D,NOOP_PROVIDER:()=>A,OpenFeature:()=>F,OpenFeatureAPI:()=>I,OpenFeatureClient:()=>V,OpenFeatureEventEmitter:()=>C,ProviderEvents:()=>j.ClientProviderEvents}),e.exports=(e=>_(s({},"__esModule",{value:!0}),e))(O);var P=r(4878),w=r(4878),R=r(4878),S=((e,t,r)=>(r=null!=e?o(h(e)):{},_(e&&e.__esModule?r:s(r,"default",{value:e,enumerable:!0}),e)))(E()),C=class extends R.GenericEventEmitter{constructor(){super(),this.eventEmitter=new S.default({captureRejections:!0}),this.eventEmitter.on("error",(e=>{var t;null==(t=this._logger)||t.error("Error running event handler:",e)}))}},j=r(4878),N=r(4878),A=new class{constructor(){this.metadata={name:"No-op Provider"}}get status(){return N.ProviderStatus.NOT_READY}resolveBooleanEvaluation(e,t){return this.noOp(t)}resolveStringEvaluation(e,t){return this.noOp(t)}resolveNumberEvaluation(e,t){return this.noOp(t)}resolveObjectEvaluation(e,t){return this.noOp(t)}noOp(e){return{value:e,reason:"No-op"}}},T=r(4878),x=r(4878),M=class extends x.OpenFeatureError{constructor(e){super(e),Object.setPrototypeOf(this,M.prototype),this.name="VariantNotFoundError",this.code=x.ErrorCode.GENERAL}},D=class{constructor(e={}){this.events=new C,this.runsOn="client",this.status=T.ProviderStatus.NOT_READY,this.metadata={name:"in-memory"},this._flagConfiguration=m({},e)}initialize(e){return b(this,null,(function*(){try{for(const t in this._flagConfiguration)this.resolveFlagWithReason(t,e);this._context=e,this.status=T.ProviderStatus.READY}catch(e){throw this.status=T.ProviderStatus.ERROR,e}}))}putConfiguration(e){return b(this,null,(function*(){const t=Object.entries(e).filter((([e,t])=>this._flagConfiguration[e]!==t)).map((([e])=>e));this.status=T.ProviderStatus.STALE,this.events.emit(j.ClientProviderEvents.Stale),this._flagConfiguration=m({},e),this.events.emit(j.ClientProviderEvents.ConfigurationChanged,{flagsChanged:t});try{yield this.initialize(this._context),this.events.emit(j.ClientProviderEvents.Ready)}catch(e){throw this.events.emit(j.ClientProviderEvents.Error),e}}))}resolveBooleanEvaluation(e,t,r,n){return this.resolveAndCheckFlag(e,t,r||this._context,n)}resolveNumberEvaluation(e,t,r,n){return this.resolveAndCheckFlag(e,t,r||this._context,n)}resolveStringEvaluation(e,t,r,n){return this.resolveAndCheckFlag(e,t,r||this._context,n)}resolveObjectEvaluation(e,t,r,n){return this.resolveAndCheckFlag(e,t,r||this._context,n)}resolveAndCheckFlag(e,t,r,n){if(!(e in this._flagConfiguration)){const t=`no flag found with key ${e}`;throw null==n||n.debug(t),new T.FlagNotFoundError(t)}if(this._flagConfiguration[e].disabled)return{value:t,reason:T.StandardResolutionReasons.DISABLED};const i=this.resolveFlagWithReason(e,r);if(void 0===i.value){const t=`no value associated with variant provided for ${e} found`;throw null==n||n.error(t),new M(t)}if(typeof i.value!=typeof t)throw new T.TypeMismatchError;return i}resolveFlagWithReason(e,t){try{return this.lookupFlagValue(e,t)}catch(e){if(!(e instanceof T.OpenFeatureError))throw new T.GeneralError((null==e?void 0:e.message)||"unknown error");throw e}}lookupFlagValue(e,t){var r;const n=this._flagConfiguration[e],i=t&&(null==n?void 0:n.contextEvaluator),o=i?null==(r=n.contextEvaluator)?void 0:r.call(n,t):n.defaultVariant,s=o&&(null==n?void 0:n.variants[o]),a=i?T.StandardResolutionReasons.TARGETING_MATCH:T.StandardResolutionReasons.STATIC,l=this.status===T.ProviderStatus.STALE?T.StandardResolutionReasons.CACHED:a;return y(m({value:s},o&&{variant:o}),{reason:l})}},k=Symbol.for("@openfeature/web-sdk/api"),L=globalThis,I=class extends w.OpenFeatureCommonAPI{constructor(){super("client"),this._events=new C,this._defaultProvider=A,this._createEventEmitter=()=>new C,this._namedProviderContext=new Map}static getInstance(){const e=L[k];if(e)return e;const t=new I;return L[k]=t,t}setContext(e,t){return b(this,null,(function*(){var r,n;const i=(0,w.stringOrUndefined)(e),o=null!=(n=null!=(r=(0,w.objectOrUndefined)(e))?r:(0,w.objectOrUndefined)(t))?n:{};if(i){const e=this._clientProviders.get(i);if(e){const t=this.getContext(i);this._namedProviderContext.set(i,o),yield this.runProviderContextChangeHandler(i,e,t,o)}else this._namedProviderContext.set(i,o)}else{const e=this._context;this._context=o;const t=Array.from(this._clientProviders.entries()).filter((([e])=>!this._namedProviderContext.has(e))).reduce(((e,[t,r])=>(e.push({name:t,provider:r}),e)),[]),r=[{name:void 0,provider:this._defaultProvider},...t];yield Promise.all(r.map((t=>this.runProviderContextChangeHandler(t.name,t.provider,e,o))))}}))}getContext(e){const t=(0,w.stringOrUndefined)(e);if(t){const e=this._namedProviderContext.get(t);if(e)return e;this._logger.debug(`Unable to find context for '${t}'.`)}return this._context}clearContext(e){return b(this,null,(function*(){const t=(0,w.stringOrUndefined)(e);if(!t)return this.setContext({});{const e=this._clientProviders.get(t);if(e){const r=this.getContext(t);this._namedProviderContext.delete(t);const n=this.getContext();yield this.runProviderContextChangeHandler(t,e,r,n)}else this._namedProviderContext.delete(t)}}))}clearContexts(){return b(this,null,(function*(){yield this.clearContext(),yield Promise.allSettled(Array.from(this._clientProviders.keys()).map((e=>this.clearContext(e))))}))}getClient(e,t){return new V((()=>this.getProviderForClient(e)),(()=>this.buildAndCacheEventEmitterForClient(e)),(()=>this._logger),{name:e,version:t})}clearProviders(){return b(this,null,(function*(){var e;yield(e=I.prototype,this,"clearProvidersAndSetDefault",p(h(e),"clearProvidersAndSetDefault",this)).call(this,A),this._namedProviderContext.clear()}))}runProviderContextChangeHandler(e,t,r,n){return b(this,null,(function*(){var i,o,s,a,l;const u=t.metadata.name;try{yield null==(i=t.onContextChange)?void 0:i.call(t,r,n),this.getAssociatedEventEmitters(e).forEach((t=>{null==t||t.emit(j.ClientProviderEvents.ContextChanged,{clientName:e,providerName:u})})),null==(o=this._events)||o.emit(j.ClientProviderEvents.ContextChanged,{clientName:e,providerName:u})}catch(r){const n=r,i=`Error running ${null==(s=null==t?void 0:t.metadata)?void 0:s.name}'s context change handler: ${null==n?void 0:n.message}`;null==(a=this._logger)||a.error(`${i}`,r),this.getAssociatedEventEmitters(e).forEach((t=>{null==t||t.emit(j.ClientProviderEvents.Error,{clientName:e,providerName:u,message:i})})),null==(l=this._events)||l.emit(j.ClientProviderEvents.Error,{clientName:e,providerName:u,message:i})}}))}},F=I.getInstance(),V=class{constructor(e,t,r,n){this.providerAccessor=e,this.emitterAccessor=t,this.globalLogger=r,this.options=n,this._hooks=[]}get metadata(){return{name:this.options.name,version:this.options.version,providerMetadata:this.providerAccessor().metadata}}get providerStatus(){var e;return(null==(e=this.providerAccessor())?void 0:e.status)||P.ProviderStatus.READY}addHandler(e,t){var r;if(this.emitterAccessor().addHandler(e,t),(0,P.statusMatchesEvent)(e,this._provider.status))try{t({clientName:this.metadata.name,providerName:this._provider.metadata.name})}catch(e){null==(r=this._logger)||r.error("Error running event handler:",e)}}removeHandler(e,t){this.emitterAccessor().removeHandler(e,t)}getHandlers(e){return this.emitterAccessor().getHandlers(e)}setLogger(e){return this._clientLogger=new P.SafeLogger(e),this}addHooks(...e){return this._hooks=[...this._hooks,...e],this}getHooks(){return this._hooks}clearHooks(){return this._hooks=[],this}getBooleanValue(e,t,r){return this.getBooleanDetails(e,t,r).value}getBooleanDetails(e,t,r){return this.evaluate(e,this._provider.resolveBooleanEvaluation,t,"boolean",r)}getStringValue(e,t,r){return this.getStringDetails(e,t,r).value}getStringDetails(e,t,r){return this.evaluate(e,this._provider.resolveStringEvaluation,t,"string",r)}getNumberValue(e,t,r){return this.getNumberDetails(e,t,r).value}getNumberDetails(e,t,r){return this.evaluate(e,this._provider.resolveNumberEvaluation,t,"number",r)}getObjectValue(e,t,r){return this.getObjectDetails(e,t,r).value}getObjectDetails(e,t,r){return this.evaluate(e,this._provider.resolveObjectEvaluation,t,"object",r)}evaluate(e,t,r,n,i={}){var o,s;const a=[...F.getHooks(),...this.getHooks(),...i.hooks||[],...this._provider.hooks||[]],l=[...a].reverse(),u=m({},F.getContext(null==(o=null==this?void 0:this.options)?void 0:o.name)),c={flagKey:e,defaultValue:r,flagValueType:n,clientMetadata:this.metadata,providerMetadata:F.providerMetadata,context:u,logger:this._logger};try{this.beforeHooks(a,c,i);const n=t.call(this._provider,e,r,u,this._logger),o=y(m({},n),{flagMetadata:Object.freeze(null!=(s=n.flagMetadata)?s:{}),flagKey:e});return this.afterHooks(l,c,o,i),o}catch(t){const n=null==t?void 0:t.message,o=(null==t?void 0:t.code)||P.ErrorCode.GENERAL;return this.errorHooks(l,c,t,i),{errorCode:o,errorMessage:n,value:r,reason:P.StandardResolutionReasons.ERROR,flagMetadata:Object.freeze({}),flagKey:e}}finally{this.finallyHooks(l,c,i)}}beforeHooks(e,t,r){var n;Object.freeze(t),Object.freeze(t.context);for(const i of e)null==(n=null==i?void 0:i.before)||n.call(i,t,Object.freeze(r.hookHints))}afterHooks(e,t,r,n){var i;for(const o of e)null==(i=null==o?void 0:o.after)||i.call(o,t,r,n.hookHints)}errorHooks(e,t,r,n){var i;for(const o of e)try{null==(i=null==o?void 0:o.error)||i.call(o,t,r,n.hookHints)}catch(e){this._logger.error(`Unhandled error during 'error' hook: ${e}`),e instanceof Error&&this._logger.error(e.stack),this._logger.error(null==e?void 0:e.stack)}}finallyHooks(e,t,r){var n;for(const i of e)try{null==(n=null==i?void 0:i.finally)||n.call(i,t,r.hookHints)}catch(e){this._logger.error(`Unhandled error during 'finally' hook: ${e}`),e instanceof Error&&this._logger.error(e.stack),this._logger.error(null==e?void 0:e.stack)}}get _provider(){return this.providerAccessor()}get _logger(){return this._clientLogger||this.globalLogger()}};((e,t,r)=>{_(e,t,"default"),r&&_(r,t,"default")})(O,r(4878),e.exports)}},t={};return function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}(3607)})()));
//# sourceMappingURL=index.js.map